{
  "hash": "713b414a117f7e2dd7cfc91e9b1f066a",
  "result": {
    "engine": "knitr",
    "markdown": "---\nexecute:\n  echo: true   # set to true to show musterlösung\n  output: true # set to true to show musterlösung\ncode-fold: true\ncode-summary: \"Musterlösung\"\nknitr:\n  opts_chunk: \n    collapse: true\n---\n\n\n# Berechnung Homeranges\n\n## Libraries laden\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(\"sf\")\nlibrary(\"terra\")\nlibrary(\"dplyr\")\nlibrary(\"readr\")\nlibrary(\"ggplot2\")\nlibrary(\"terra\")\nlibrary(\"adehabitatHR\")\nlibrary(\"ggspatial\")\n```\n:::\n\n\n## Daten einlesen\n\nEinlesen des Gesamtdatensatzes von Moodle, Sichtung des Datensatzes und der Datentypen\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\nRehe <- read_delim(\"datasets/fallstudie_n/Aufgabe3_Homeranges_Rehe_landforst_241011.csv\", delim = \";\")\n\nstr(Rehe)\n```\n:::\n\n\n## Aufgabe 1\n\nIm Datensatz Rehe eine neue Spalte mit Datum und Zeit in einer Spalte kreieren. Beim Format hat sich ein Fehler eingeschlichen. Findet ihr ihn?\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\nRehe <- Rehe |>\n  mutate(UTC_DateTime = as.POSIXct(paste(UTC_Date, UTC_Time),\n                                   format = \"%Y-%m-%d %H:%M:%S\"))\n```\n:::\n\n\n## Aufgabe 2\n\nMit den folgenden Zeilen können die GPS-Punkte visualisiert werden\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\nRehe_sf <- st_as_sf(Rehe, coords = c(\"X\", \"Y\"), crs = 21781)\n\nRE13 <- filter(Rehe_sf, TierID == \"RE13\")\n\nplot(RE13[\"TierID\"])\n```\n\n::: {.cell-output-display}\n![](3_Berechnung_Homeranges_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\nHier einige Zeilen Code, um eine HomeRange zu berechnen.\n\nHerumschrauben an der Ausdehnung, resp. prozentualer Anteil Punkte in der HR (Funktion getverticeshr) \n\n**→ Ziel: eine Karte erstellen mit der Visualiserung mindestens einer HR**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\nRE13_xy <- st_coordinates(RE13)\n\nRE13_sp <- as(RE13[\"TierID\"], \"Spatial\")\n\nsigma <- 0.5 * (sd(RE13_xy[, 1]) + sd(RE13_xy[, 2]))\nn <- nrow(RE13)\nhref <- sigma * n ^ (-1 / 6) * 0.9 # scaled reference: href * 0.9\n\nkud <- kernelUD(RE13_sp, h = href, grid = 25) \n\nhomerange <- getverticeshr(kud, percent = 95) # Berechnung der Home Range (95% Isopleth)\n\n# Schreibt HR in den oben beschriebenen Ordner (als Shapefile)\n\nhr <- st_as_sf(homerange)\n\nst_write(\n  hr,\n  dsn = \"results\",\n  layer = \"HR_RE13\",\n  driver = \"ESRI Shapefile\",\n  delete_layer = TRUE\n)\n## Deleting layer `HR_RE13' using driver `ESRI Shapefile'\n## Writing layer `HR_RE13' to data source `results' using driver `ESRI Shapefile'\n## Writing 1 features with 2 fields and geometry type Polygon.\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\n# mit diesem Befehl kann die HR geplottet werden\n\nggplot(hr) + \n  geom_sf(size = 1, alpha = 0.3, color = \"red\", fill=\"red\") +\n  coord_sf(datum = sf::st_crs(21781))+\n  theme(\n    axis.title = element_blank(),\n    axis.text = element_blank(),\n    axis.ticks = element_blank(),\n    legend.position=\"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](3_Berechnung_Homeranges_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code  code-fold=\"false\"}\n\n# und die Punkte der GPS-Lokalisationen darüber gelegt werden \n\nggplot(hr) + \n  geom_sf(size = 1, alpha = 0.3, color = \"red\", fill=\"red\") +\n  geom_sf(data = RE13, aes(fill = \"red\")) +\n  coord_sf(datum = sf::st_crs(21781))+\n  theme(\n    axis.title = element_blank(),\n    axis.text = element_blank(),\n    axis.ticks = element_blank(),\n    legend.position=\"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](3_Berechnung_Homeranges_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\nCode um die Homerange auf der Landeskarte 1:25000 zu plotten. Transparenz kann mit alpha angepasst werden.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\npk25_wpz <- rast(\"datasets/fallstudie_n/pk25_wpz.tif\")\n\nggplot(hr, aes(color = \"red\", fill = \"red\")) +\n  annotation_spatial(pk25_wpz) +\n  geom_sf(size = 1, alpha = 0.3) +\n  geom_sf(data = RE13, aes(fill = \"red\")) +\n  coord_sf(datum = sf::st_crs(21781)) +\n  theme(\n    axis.title = element_blank(),\n    axis.text = element_blank(),\n    axis.ticks = element_blank(),\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](3_Berechnung_Homeranges_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nNachbauen des Sampling Grids mit den Kreisen (Wird als Grundlage für Extraktion der Umweltvariablen innerhalb der Homeranges benötigt)\n\n- Ausdehnung des Grids basiert auf `hr`\n- Cellsize des Grids: 25m\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\nx25 <- st_make_grid(hr, 25, what = \"centers\")\ngrid_plot <- st_buffer(x25, 12.5)\n\nggplot(grid_plot, color = \"black\", fill = NA) +\n  geom_sf() +\n  geom_sf(data = RE13, color = \"blue\", ) +\n  geom_sf(data = hr, color = \"red\", fill = NA, size = 2) +\n  coord_sf(datum = 21781) +\n  theme(\n    axis.title = element_blank(),\n    axis.text = element_blank(),\n    axis.ticks = element_blank(),\n    legend.position = \"none\"\n  )\n```\n\n::: {.cell-output-display}\n![](3_Berechnung_Homeranges_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n## Aufgabe 3\n\nTesten der Variablen der Vegetationsschichten von letzter Woche auf einen linearen Zusammenhang (Korrelation; Funktion cor.test). DG_Baumschicht vs. DG_os / DG_Strauchschicht vs. DG_us aus dem Datensatz df_with_lidar_2024 den wir letzte Woche erstellt haben\n\n**Die Theorie in den Vormittagslektionen zu Korrelation folgt erst ab 29.10.**\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n\ndf_with_lidar <- read_delim(\"datasets/fallstudie_n/df_with_lidar_2024.csv\", delim = \";\")\n\ncor.test(~ DG_Strauchschicht + DG_us_2022, data = df_with_lidar, method = \"pearson\")\n## \n## \tPearson's product-moment correlation\n## \n## data:  DG_Strauchschicht and DG_us_2022\n## t = 4.3863, df = 171, p-value = 2.011e-05\n## alternative hypothesis: true correlation is not equal to 0\n## 95 percent confidence interval:\n##  0.1772221 0.4460498\n## sample estimates:\n##       cor \n## 0.3180136\n```\n:::\n",
    "supporting": [
      "3_Berechnung_Homeranges_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}