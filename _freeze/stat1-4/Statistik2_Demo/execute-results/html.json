{
  "hash": "d2194819dda6ea615266f28e28716a45",
  "result": {
    "markdown": "---\ndate: 2023-10-31\nlesson: Stat2\nthema: Einführung in lineare Modelle\nindex: 1\nformat:\n  html:\n    code-tools:\n      source: true\nknitr:\n    opts_chunk:\n        collapse: false\n---\n\n\n# Stat2: Demo\n\n- Download dieses Demoscript via \"\\</\\>Code\" (oben rechts)\n- Datensatz *Nitrogen.csv*\n- Datensatz *Riesch_et_al_ReMe_Extract.csv*\n\n## t-test als ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren als \"long table\" (2 Kategorien)\na <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14)\nb <- c(12, 15, 16, 7, 8, 10, 12, 11, 13, 10)\nblume <- data.frame(cultivar = c(rep(\"a\", 10), rep(\"b\", 10)), size = c(a, b))\n\n# Daten anschauen\npar(mfrow = c(1, 1))\nboxplot(size ~ cultivar, xlab = \"Sorte\", ylab = \"Bluetengroesse [cm]\", data = blume)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Klassischer t-Test ausführen\nt.test(size ~ cultivar, blume, var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tTwo Sample t-test\n\ndata:  size by cultivar\nt = 2.0797, df = 18, p-value = 0.05212\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -0.03981237  7.83981237\nsample estimates:\nmean in group a mean in group b \n           15.3            11.4 \n```\n:::\n\n```{.r .cell-code}\n# ANOVA ausführen\naov(size ~ cultivar, data = blume)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = size ~ cultivar, data = blume)\n\nTerms:\n                cultivar Residuals\nSum of Squares     76.05    316.50\nDeg. of Freedom        1        18\n\nResidual standard error: 4.193249\nEstimated effects may be unbalanced\n```\n:::\n\n```{.r .cell-code}\nsummary(aov(size ~ cultivar, data = blume))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value Pr(>F)  \ncultivar     1   76.0   76.05   4.325 0.0521 .\nResiduals   18  316.5   17.58                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary.lm(aov(size ~ cultivar, data = blume))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\naov(formula = size ~ cultivar, data = blume)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -2.575 -0.350  2.925  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.326   11.54 9.47e-10 ***\ncultivarb     -3.900      1.875   -2.08   0.0521 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.193 on 18 degrees of freedom\nMultiple R-squared:  0.1937,\tAdjusted R-squared:  0.1489 \nF-statistic: 4.325 on 1 and 18 DF,  p-value: 0.05212\n```\n:::\n:::\n\n\n## Echte ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren mit 3 statt nur 2 Kategorien\nc <- c(30, 19, 31, 23, 18, 25, 26, 24, 17, 20)\nblume2 <- data.frame(cultivar = c(rep(\"a\", 10), rep(\"b\", 10), rep(\"c\", 10)), size = c(a, b, c))\nblume2$cultivar <- as.factor(blume2$cultivar)\n\nsummary(blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n cultivar      size      \n a:10     Min.   : 7.00  \n b:10     1st Qu.:11.25  \n c:10     Median :15.50  \n          Mean   :16.67  \n          3rd Qu.:20.00  \n          Max.   :31.00  \n```\n:::\n\n```{.r .cell-code}\nhead(blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  cultivar size\n1        a   20\n2        a   19\n3        a   25\n4        a   10\n5        a    8\n6        a   15\n```\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1))\nboxplot(size ~ cultivar, xlab = \"Sorte\", ylab = \"Blütengrösse [cm]\", data = blume2)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\naov(size ~ cultivar, data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nCall:\n   aov(formula = size ~ cultivar, data = blume2)\n\nTerms:\n                cultivar Residuals\nSum of Squares  736.0667  528.6000\nDeg. of Freedom        2        27\n\nResidual standard error: 4.424678\nEstimated effects may be unbalanced\n```\n:::\n\n```{.r .cell-code}\nsummary(aov(size ~ cultivar, data = blume2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  736.1   368.0    18.8 7.68e-06 ***\nResiduals   27  528.6    19.6                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary.lm(aov(size ~ cultivar, data = blume2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\naov(formula = size ~ cultivar, data = blume2)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -3.375 -0.300  2.700  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.399  10.935 2.02e-11 ***\ncultivarb     -3.900      1.979  -1.971 0.059065 .  \ncultivarc      8.000      1.979   4.043 0.000395 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.425 on 27 degrees of freedom\nMultiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \nF-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n```\n:::\n\n```{.r .cell-code}\naov.1 <- aov(size ~ cultivar, data = blume2)\nsummary(aov.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  736.1   368.0    18.8 7.68e-06 ***\nResiduals   27  528.6    19.6                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary.lm(aov.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\naov(formula = size ~ cultivar, data = blume2)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -3.375 -0.300  2.700  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.399  10.935 2.02e-11 ***\ncultivarb     -3.900      1.979  -1.971 0.059065 .  \ncultivarc      8.000      1.979   4.043 0.000395 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.425 on 27 degrees of freedom\nMultiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \nF-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n```\n:::\n\n```{.r .cell-code}\n# Berechnung Mittelwerte usw. zur Charakterisierung der Gruppen mittels dplyr-Funktionen\n\nlibrary(\"dplyr\")\n\nblume2 |> \n  group_by(cultivar) |>\n  summarise(\n    Mean = mean(size), \n    SD = sd(size),\n    Min = min(size),\n    Max = max(size)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 3 × 5\n  cultivar  Mean    SD   Min   Max\n  <fct>    <dbl> <dbl> <dbl> <dbl>\n1 a         15.3  5.21     8    25\n2 b         11.4  2.84     7    16\n3 c         23.3  4.85    17    31\n```\n:::\n\n```{.r .cell-code}\nlm.1 <- lm(size ~ cultivar, data = blume2)\nsummary(lm.1)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = size ~ cultivar, data = blume2)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -3.375 -0.300  2.700  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.399  10.935 2.02e-11 ***\ncultivarb     -3.900      1.979  -1.971 0.059065 .  \ncultivarc      8.000      1.979   4.043 0.000395 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.425 on 27 degrees of freedom\nMultiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \nF-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n```\n:::\n:::\n\n\n## Tukeys Posthoc-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"agricolae\")\n\n# Posthoc-Test\nHSD.test(aov.1, \"cultivar\", group = FALSE, console = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov.1 ~ \"cultivar\"\n\nHSD Test for size \n\nMean Square Error:  19.57778 \n\ncultivar,  means\n\n  size      std  r       se Min Max   Q25  Q50   Q75\na 15.3 5.207900 10 1.399206   8  25 11.50 14.5 18.75\nb 11.4 2.836273 10 1.399206   7  16 10.00 11.5 12.75\nc 23.3 4.854551 10 1.399206  17  31 19.25 23.5 25.75\n\nAlpha: 0.05 ; DF Error: 27 \nCritical Value of Studentized Range: 3.506426 \n\nComparison between treatments means\n\n      difference pvalue signif.        LCL       UCL\na - b        3.9 0.1388          -1.006213  8.806213\na - c       -8.0 0.0011      ** -12.906213 -3.093787\nb - c      -11.9 0.0000     *** -16.806213 -6.993787\n```\n:::\n:::\n\n\n## Beispiel Posthoc-Labels in Plot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# ANOVA Mit Iris-Datenset, das in R integriert ist\naov.2 <- aov(Sepal.Width ~ Species, data = iris)\n\n# Posthoc-Test\nHSD.test(aov.2, \"Species\", console = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nStudy: aov.2 ~ \"Species\"\n\nHSD Test for Sepal.Width \n\nMean Square Error:  0.1153878 \n\nSpecies,  means\n\n           Sepal.Width       std  r        se Min Max   Q25 Q50   Q75\nsetosa           3.428 0.3790644 50 0.0480391 2.3 4.4 3.200 3.4 3.675\nversicolor       2.770 0.3137983 50 0.0480391 2.0 3.4 2.525 2.8 3.000\nvirginica        2.974 0.3224966 50 0.0480391 2.2 3.8 2.800 3.0 3.175\n\nAlpha: 0.05 ; DF Error: 147 \nCritical Value of Studentized Range: 3.348424 \n\nMinimun Significant Difference: 0.1608553 \n\nTreatments with the same letter are not significantly different.\n\n           Sepal.Width groups\nsetosa           3.428      a\nvirginica        2.974      b\nversicolor       2.770      c\n```\n:::\n\n```{.r .cell-code}\n# Plot mit labels\nboxplot(Sepal.Width ~ Species, data = iris)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(Sepal.Width ~ Species, ylim = c(2, 5), data = iris)\ntext(1, 4.8, \"a\")\ntext(2, 4.8, \"c\")\ntext(3, 4.8, \"b\")\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-4-2.png){width=672}\n:::\n:::\n\n\nDerselbe Plot mit ggplot\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"ggplot2\")\n\nggplot(iris, aes(Species, Sepal.Width)) +\n    geom_boxplot(size = 1) +\n    annotate(\"text\", y = 5, x = 1:3, label = c(\"a\", \"c\", \"b\"))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## Klassische Tests der Modellannahmen (NICHT EMPFOHLEN!!!)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Shapiro-Wilk Test auf Normalverteilung\n# Pro Kategorie!\n# (H0 = Notmalverteilung)\nshapiro.test(blume2$size[blume2$cultivar == \"a\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  blume2$size[blume2$cultivar == \"a\"]\nW = 0.97304, p-value = 0.9175\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(blume2$size[blume2$cultivar == \"b\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  blume2$size[blume2$cultivar == \"b\"]\nW = 0.97341, p-value = 0.9206\n```\n:::\n\n```{.r .cell-code}\nshapiro.test(blume2$size[blume2$cultivar == \"c\"])\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tShapiro-Wilk normality test\n\ndata:  blume2$size[blume2$cultivar == \"c\"]\nW = 0.94188, p-value = 0.5742\n```\n:::\n\n```{.r .cell-code}\n?var.test\n\n# F-Test zum Vergleich zweier Varianzen\n# (H0= Gleiche Varianzen)\nvar.test(\n    blume2$size[blume2$cultivar == \"a\"],\n    blume2$size[blume2$cultivar == \"b\"]\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tF test to compare two variances\n\ndata:  blume2$size[blume2$cultivar == \"a\"] and blume2$size[blume2$cultivar == \"b\"]\nF = 3.3715, num df = 9, denom df = 9, p-value = 0.08467\nalternative hypothesis: true ratio of variances is not equal to 1\n95 percent confidence interval:\n  0.8374446 13.5738284\nsample estimates:\nratio of variances \n          3.371547 \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"car\")\n\n# Test auf Homogenität der Varianzen\nleveneTest(blume2$size[blume2$cultivar == \"a\"],\n    blume2$size[blume2$cultivar == \"b\"],\n    center = mean\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nLevene's Test for Homogeneity of Variance (center = mean)\n      Df    F value    Pr(>F)    \ngroup  7 2.2598e+30 < 2.2e-16 ***\n       2                         \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Nicht-parametrische Alternativen, wenn Modellannahmen der ANVOA massiv verletzt sind\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Nicht-parametrische Alternative zu t-Test\nwilcox.test(\n    blume2$size[blume2$cultivar == \"a\"],\n    blume2$size[blume2$cultivar == \"b\"]\n)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  blume2$size[blume2$cultivar == \"a\"] and blume2$size[blume2$cultivar == \"b\"]\nW = 73, p-value = 0.08789\nalternative hypothesis: true location shift is not equal to 0\n```\n:::\n:::\n\n\n## Zum Vergleich normale ANOVA noch mal\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(aov(size ~ cultivar, data = blume2))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  736.1   368.0    18.8 7.68e-06 ***\nResiduals   27  528.6    19.6                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n:::\n\n\n## Bei starken Abweichungen von der Normalverteilung, aber ähnlichen Varianzen\n\n## Kruskal-Wallis-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\nkruskal.test(size ~ cultivar, data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  size by cultivar\nKruskal-Wallis chi-squared = 16.686, df = 2, p-value = 0.0002381\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"FSA\")\n\n# korrigierte p-Werte nach Bejamini-Hochberg\ndunnTest(size ~ cultivar, method = \"bh\", data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  Comparison         Z      P.unadj        P.adj\n1      a - b  1.526210 1.269575e-01 0.1269575490\n2      a - c -2.518247 1.179407e-02 0.0176911039\n3      b - c -4.044457 5.244459e-05 0.0001573338\n```\n:::\n:::\n\n\n## Bei erheblicher Heteroskedastizität, aber relative normal/symmetrisch verteilten Residuen\n\n## Welch-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\noneway.test(size ~ cultivar, var.equal = F, data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  size and cultivar\nF = 21.642, num df = 2.000, denom df = 16.564, p-value = 2.397e-05\n```\n:::\n:::\n\n\n## 2-faktorielle ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren\nd <- c(10, 12, 11, 13, 10, 25, 12, 30, 26, 13)\ne <- c(15, 13, 18, 11, 14, 25, 39, 38, 28, 24)\nf <- c(10, 12, 11, 13, 10, 9, 2, 4, 7, 13)\n\nblume3 <- data.frame(\n    cultivar = c(rep(\"a\", 20), rep(\"b\", 20), rep(\"c\", 20)),\n    house = c(rep(c(rep(\"yes\", 10), rep(\"no\", 10)), 3)),\n    size = c(a, b, c, d, e, f)\n)\n\nblume3\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n   cultivar house size\n1         a   yes   20\n2         a   yes   19\n3         a   yes   25\n4         a   yes   10\n5         a   yes    8\n6         a   yes   15\n7         a   yes   13\n8         a   yes   18\n9         a   yes   11\n10        a   yes   14\n11        a    no   12\n12        a    no   15\n13        a    no   16\n14        a    no    7\n15        a    no    8\n16        a    no   10\n17        a    no   12\n18        a    no   11\n19        a    no   13\n20        a    no   10\n21        b   yes   30\n22        b   yes   19\n23        b   yes   31\n24        b   yes   23\n25        b   yes   18\n26        b   yes   25\n27        b   yes   26\n28        b   yes   24\n29        b   yes   17\n30        b   yes   20\n31        b    no   10\n32        b    no   12\n33        b    no   11\n34        b    no   13\n35        b    no   10\n36        b    no   25\n37        b    no   12\n38        b    no   30\n39        b    no   26\n40        b    no   13\n41        c   yes   15\n42        c   yes   13\n43        c   yes   18\n44        c   yes   11\n45        c   yes   14\n46        c   yes   25\n47        c   yes   39\n48        c   yes   38\n49        c   yes   28\n50        c   yes   24\n51        c    no   10\n52        c    no   12\n53        c    no   11\n54        c    no   13\n55        c    no   10\n56        c    no    9\n57        c    no    2\n58        c    no    4\n59        c    no    7\n60        c    no   13\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(size ~ cultivar + house, data = blume3)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary(aov(size ~ cultivar + house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  417.1   208.5   5.005     0.01 *  \nhouse        1  992.3   992.3  23.815 9.19e-06 ***\nResiduals   56 2333.2    41.7                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(aov(size ~ cultivar + house + cultivar:house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar        2  417.1   208.5   5.364   0.0075 ** \nhouse           1  992.3   992.3  25.520 5.33e-06 ***\ncultivar:house  2  233.6   116.8   3.004   0.0579 .  \nResiduals      54 2099.6    38.9                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# Kurzschreibweise: \"*\" bedeutet, dass Interaktion zwischen cultivar und house eingeschlossen wird\nsummary(aov(size ~ cultivar * house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n               Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar        2  417.1   208.5   5.364   0.0075 ** \nhouse           1  992.3   992.3  25.520 5.33e-06 ***\ncultivar:house  2  233.6   116.8   3.004   0.0579 .  \nResiduals      54 2099.6    38.9                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary.lm(aov(size ~ cultivar + house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\naov(formula = size ~ cultivar + house, data = blume3)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-9.733 -4.696 -1.050  2.717 19.133 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    9.283      1.667   5.570 7.52e-07 ***\ncultivarb      6.400      2.041   3.135  0.00273 ** \ncultivarc      2.450      2.041   1.200  0.23509    \nhouseyes       8.133      1.667   4.880 9.19e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.455 on 56 degrees of freedom\nMultiple R-squared:  0.3766,\tAdjusted R-squared:  0.3432 \nF-statistic: 11.28 on 3 and 56 DF,  p-value: 6.848e-06\n```\n:::\n\n```{.r .cell-code}\ninteraction.plot(blume3$cultivar, blume3$house, blume3$size)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-14-2.png){width=672}\n:::\n\n```{.r .cell-code}\ninteraction.plot(blume3$house, blume3$cultivar, blume3$size)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-14-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nanova(lm(blume3$size ~ blume3$cultivar * blume3$house), lm(blume3$size ~ blume3$cultivar + blume3$house))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: blume3$size ~ blume3$cultivar * blume3$house\nModel 2: blume3$size ~ blume3$cultivar + blume3$house\n  Res.Df    RSS Df Sum of Sq      F  Pr(>F)  \n1     54 2099.6                              \n2     56 2333.2 -2   -233.63 3.0044 0.05792 .\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nanova(lm(blume3$size ~ blume3$house), lm(blume3$size ~ blume3$cultivar * blume3$house))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nModel 1: blume3$size ~ blume3$house\nModel 2: blume3$size ~ blume3$cultivar * blume3$house\n  Res.Df    RSS Df Sum of Sq      F   Pr(>F)   \n1     58 2750.3                                \n2     54 2099.6  4    650.73 4.1841 0.005045 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\n# Visualisierung 2-fach-Interaktion etwas elaborierter mit ggplot\nlibrary(\"sjPlot\")\ntheme_set(theme_classic())\n\naov <- aov(size ~ cultivar * house, data = blume3)\nplot_model(aov, type = \"pred\", terms = c(\"cultivar\", \"house\"))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Geht auch für 3-fach-Interaktionen\n\n# Datensatz zum Einfluss von Management und Hirschbeweidung auf den Pflanzenartenreichtum\n\nlibrary(\"readr\")\n\nRiesch <- read_delim(\"datasets/stat1-4/Riesch_et_al_ReMe_Extract.csv\",\";\", col_types = cols(\"Year\" = \"f\", \"Treatment\" = \"f\", \"Plot.type\" = \"f\"))\n\nstr(Riesch)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [60 × 5] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ Plot.ID         : chr [1:60] \"Eul_C1_BK_14\" \"Kug_B1_BK_14\" \"Nun_C1_BK_14\" \"SomO_A1_BK_14\" ...\n $ Year            : Factor w/ 2 levels \"Year 1\",\"Year 4\": 1 1 1 1 1 2 2 2 2 2 ...\n $ Treatment       : Factor w/ 3 levels \"burnt\",\"mown\",..: 1 1 1 1 1 1 1 1 1 1 ...\n $ Plot.type       : Factor w/ 2 levels \"fenced\",\"open\": 1 1 1 1 1 1 1 1 1 1 ...\n $ Species.richness: num [1:60] 45 49 44 52 43 37 42 36 46 38 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   Plot.ID = col_character(),\n  ..   Year = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),\n  ..   Treatment = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),\n  ..   Plot.type = col_factor(levels = NULL, ordered = FALSE, include_na = FALSE),\n  ..   Species.richness = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n\n```{.r .cell-code}\naov.deer <- aov(Species.richness ~ Year * Treatment * Plot.type, data = Riesch)\nplot_model(aov.deer, type = \"pred\", terms = c(\"Year\", \"Treatment\", \"Plot.type\"))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n## Korrelationen\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Korrelationen und Regressionen\n\n# Datensatz zum Einfluss von Stickstoffdepositionen auf den Pflanzenartenreichtum\n\n\ndf <- read_delim(\"datasets/stat1-4/Nitrogen.csv\", \";\")\n\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n  N.deposition   Species.richness\n Min.   : 2.00   Min.   :12.0    \n 1st Qu.: 9.00   1st Qu.:17.5    \n Median :20.00   Median :21.0    \n Mean   :20.53   Mean   :20.2    \n 3rd Qu.:30.50   3rd Qu.:23.0    \n Max.   :55.00   Max.   :28.0    \n```\n:::\n\n```{.r .cell-code}\n# Plotten der Beziehung\nplot(Species.richness ~ N.deposition, data = df)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-17-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Daten anschauen\nscatterplot(Species.richness ~ N.deposition, data = df)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-17-2.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Korrelationen\ncor.test(df$Species.richness, df$N.deposition, method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  df$Species.richness and df$N.deposition\nt = -5.2941, df = 13, p-value = 0.0001453\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9405572 -0.5450218\nsample estimates:\n       cor \n-0.8265238 \n```\n:::\n\n```{.r .cell-code}\ncor.test(df$N.deposition, df$Species.richness, method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tPearson's product-moment correlation\n\ndata:  df$N.deposition and df$Species.richness\nt = -5.2941, df = 13, p-value = 0.0001453\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9405572 -0.5450218\nsample estimates:\n       cor \n-0.8265238 \n```\n:::\n\n```{.r .cell-code}\ncor.test(df$Species.richness, df$N.deposition, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tSpearman's rank correlation rho\n\ndata:  df$Species.richness and df$N.deposition\nS = 1015.5, p-value = 0.0002259\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.8133721 \n```\n:::\n\n```{.r .cell-code}\ncor.test(df$Species.richness, df$N.deposition, method = \"kendall\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n\tKendall's rank correlation tau\n\ndata:  df$Species.richness and df$N.deposition\nz = -3.308, p-value = 0.0009398\nalternative hypothesis: true tau is not equal to 0\nsample estimates:\n      tau \n-0.657115 \n```\n:::\n\n```{.r .cell-code}\n# Jetzt als Regression\nlm <- lm(Species.richness ~ N.deposition, data = df)\nanova(lm) # ANOVA-Tabelle, 1. Möglichkeit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nAnalysis of Variance Table\n\nResponse: Species.richness\n             Df Sum Sq Mean Sq F value    Pr(>F)    \nN.deposition  1 233.91 233.908  28.028 0.0001453 ***\nResiduals    13 108.49   8.346                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary.aov(lm) # ANOVA-Tabelle, 2. Möglichkeit\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n             Df Sum Sq Mean Sq F value   Pr(>F)    \nN.deposition  1  233.9  233.91   28.03 0.000145 ***\nResiduals    13  108.5    8.35                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n:::\n\n```{.r .cell-code}\nsummary(lm) # Regressionskoeffizienten\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = Species.richness ~ N.deposition, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.9184 -1.9992  0.4493  2.0015  4.6081 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  25.60502    1.26440  20.251 3.25e-11 ***\nN.deposition -0.26323    0.04972  -5.294 0.000145 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.889 on 13 degrees of freedom\nMultiple R-squared:  0.6831,\tAdjusted R-squared:  0.6588 \nF-statistic: 28.03 on 1 and 13 DF,  p-value: 0.0001453\n```\n:::\n\n```{.r .cell-code}\n# Signifikantes Ergebnis visualisieren\nplot(Species.richness ~ N.deposition, data = df)\nabline(lm)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-18-1.png){width=672}\n:::\n:::\n\n\n## Beispiele Modelldiagnostik\n\n\n::: {.cell}\n\n```{.r .cell-code}\npar(mfrow = c(2, 2)) # 4 Plots in einem Fenster\nplot(lm(b ~ a))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-19-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"ggfortify\")\n\nautoplot(lm(b ~ a))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-20-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Modellstatistik nicht OK\ng <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14, 25, 39, 38, 28, 24)\nh <- c(12, 15, 10, 7, 8, 10, 12, 11, 13, 10, 25, 12, 30, 26, 13)\npar(mfrow = c(1, 1))\n\nplot(h ~ g, xlim = c(0, 40), ylim = c(0, 30))\nabline(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-20-2.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-20-3.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelldiagnostik mit ggplot\ndf <- data.frame(g, h)\nggplot(df, aes(x = g, y = h)) +\n    # scale_x_continuous(limits = c(0,25)) +\n    # scale_y_continuous(limits = c(0,25)) +\n    geom_point() +\n    geom_smooth(method = \"lm\", color = \"black\", size = .5, se = F) +\n    theme_classic()\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-21-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nautoplot(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-21-2.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Statistik2_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}