{
  "hash": "a672a66db59a45738cdbe4ca29c9c48d",
  "result": {
    "markdown": "---\ndate: 2023-10-31\nlesson: Stat2\nthema: Einführung in lineare Modelle\nindex: 4\nformat:\n  html:\n    code-tools:\n      source: true\nknitr:\n    opts_chunk:\n        collapse: false\n---\n\n\n# Stat2: Lösung 2.1\n\n-   Download dieses Lösungsscript via \"\\</\\>Code\" (oben rechts)\n-   [Lösungstext als Download](Statistik_Loesung_2.1.pdf)\n\n## Daten einlesen und exlporieren\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"readr\")\n\nSAR <- read_delim(\"datasets/stat1-4/SAR.csv\", \";\") # Daten einlesen\nhead(SAR) # Daten anschauen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 6 × 2\n     area richness\n    <dbl>    <dbl>\n1  0.0001        2\n2  0.001         4\n3  0.01          4\n4  0.1          10\n5  1            26\n6 10            37\n```\n:::\n\n```{.r .cell-code}\nstr(SAR) # Datenformat überprüfen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nspc_tbl_ [156 × 2] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ area    : num [1:156] 1e-04 1e-03 1e-02 1e-01 1e+00 1e+01 1e-04 1e-03 1e-02 1e-01 ...\n $ richness: num [1:156] 2 4 4 10 26 37 2 5 11 15 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   area = col_double(),\n  ..   richness = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(SAR) # Überblick verschaffen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n      area             richness    \n Min.   :  0.0001   Min.   : 1.00  \n 1st Qu.:  0.0010   1st Qu.: 4.00  \n Median :  0.1000   Median : 9.00  \n Mean   :  9.4017   Mean   :16.37  \n 3rd Qu.:  1.0000   3rd Qu.:24.00  \n Max.   :100.0000   Max.   :85.00  \n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(SAR$area) # Boxplot der Flächengrösse\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n-\\> Erklärende Variable extrem rechtsschief.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nboxplot(SAR$richness) # Boxplot der Artenzahl\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n-\\> Auch abhängige Variable extrem rechtsschief.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(richness ~ area, data = SAR) # Daten plotten\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n-\\> Zusammenhang sieht nicht linear aus.\n\n**Fazit Datenexploration**: Sowohl die abhängige als auch die unabhängige Variable sind extrem rechtsschief verteilt und ihr Zusammenhang sieht nicht linear aus. Die Voraussetzungen für ein lineares Modell sehen also schlecht aus. Um diese Vermutung zu überprüfen, wird im Folgenden ein Lineares Modell mit anschliessender Modelldiagnostik gerechnet.\n\n## Einfaches lineares Modell mit Modelldiagnostik\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlm.1 <- lm(richness ~ area, data = SAR) # lm erstellen\nsummary(lm.1) # lm anschauen\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = richness ~ area, data = SAR)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-29.567  -8.474  -3.503   6.112  35.317 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  11.4742     0.9582   11.97   <2e-16 ***\narea          0.5209     0.0342   15.23   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 11.27 on 154 degrees of freedom\nMultiple R-squared:  0.601,\tAdjusted R-squared:  0.5984 \nF-statistic: 231.9 on 1 and 154 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n-\\> Zwar hochsignifikant, aber stimmen die Voraussetzungen?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modell und Daten plotten\nplot(SAR$area, SAR$richness, xlab = \"Area [m²]\", ylab = \"Species richness\") # Daten plotten\nabline(lm.1, col = \"red\") # Modell plotten\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\n-\\> Eine Gerade scheint ein schlechtes Modell zu sein für die Daten.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelldiagnostik\npar(mfrow = c(2, 2)) # 4-Plot-panel\nplot(lm.1)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n-\\> Auch Modelldiagnostikplots sehen schlecht aus.\n\n**Fazit lm**: Wie erwartet sind die Modellvoraussetzungen nicht gut erfüllt: Das geplottete Modell verläuft teils auffällig \"neben den Daten\", im Residuals vs. Fittet Plot zeigen die Residuen Trichter- und Bananenform und der Q-Q-Plot zeigt starke Abweichung der Residuen von Normalverteilung. Da drängt sich Datentransformation auf. Als nächstes wird darum Log10-Transformation ausprobiert.\n\n## Lösung A: log-Transformation der abhängigen Variablen\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten vor und nach log10-Transformation vergleichen\npar(mfrow = c(2, 2))\nboxplot(SAR$richness)\nboxplot(log10(SAR$richness))\nhist(SAR$richness)\nhist(log10(SAR$richness))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n-\\> Tansformation zeigt den gewünschten Effekt.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# lm rechnen mit log10 transformierter abhängigen Variable\nSAR$log_richness <- log10(SAR$richness)\nlm.2 <- lm(log_richness ~ area, data = SAR)\nsummary(lm.2)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log_richness ~ area, data = SAR)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.85613 -0.34114 -0.01204  0.36365  0.75729 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 0.856116   0.036657   23.36  < 2e-16 ***\narea        0.010259   0.001309    7.84 6.94e-13 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.4313 on 154 degrees of freedom\nMultiple R-squared:  0.2853,\tAdjusted R-squared:  0.2806 \nF-statistic: 61.47 on 1 and 154 DF,  p-value: 6.939e-13\n```\n:::\n:::\n\n\n-\\> Zwar hochsignifikant, aber stimmen die Voraussetzungen??\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelldiagnostik\npar(mfrow = c(2, 2))\nplot(lm.2)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n-\\> Modelldiagnostikplots sehen noch schlechter aus als mit untransformierten Daten!\n\n**Fazit Lösung A:** log-Transformation der abhängigen Variablen hat das Modell nicht verbessert. Im Gegebteil... Als nächstes wird darum eine zusätzlichge Log10-Transformation der unahängigen Variablen ausprobiert.\n\n## Lösung B: log-Transformation beider Variablen\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten vor und nach log10-Transformation vergleichen\npar(mfrow = c(2, 2))\nboxplot(SAR$area)\nboxplot(log10(SAR$area))\nhist(SAR$area)\nhist(log10(SAR$area))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n-\\> Tansformation zeigt den gewünschten Effekt.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# lm rechnen mit log10-Transformation beider VAriablen\nSAR$log_area <- log10(SAR$area)\nlm.3 <- lm(log_richness ~ log_area, data = SAR)\nsummary(lm.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\nCall:\nlm(formula = log_richness ~ log_area, data = SAR)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.50241 -0.09353  0.02130  0.09965  0.40068 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept) 1.265730   0.015607   81.10   <2e-16 ***\nlog_area    0.254440   0.006926   36.73   <2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1633 on 154 degrees of freedom\nMultiple R-squared:  0.8976,\tAdjusted R-squared:  0.8969 \nF-statistic:  1349 on 1 and 154 DF,  p-value: < 2.2e-16\n```\n:::\n:::\n\n\n-\\> Zwar hochsignifikant, aber stimmen die Voraussetzungen??\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelldiagnostik\npar(mfrow = c(2, 2))\nplot(lm.3)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-14-1.png){width=672}\n:::\n:::\n\n\n-\\> Das sieht jetzt vergleichsweise sehr gut aus! (Bis auf ein paar Aussreisser)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modell und Daten plotten\nplot(SAR$log_area, SAR$log_richness, xlab = \"log10(Area [m²])\", ylab = \"log10(Species richness)\") # Daten plotten\nabline(lm.3, col = \"red\") # Modell plotten\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-15-1.png){width=672}\n:::\n:::\n\n\n-\\> Das Modell bildet die Daten gut ab.\n\n**Fazit Lösung B:** Ein lineares Modell mit log-Transformation der unabhängigen und der abhängigen Variablen scheint die Daten am besten abzubilden. Abschliessend sollen nun die drei Modelle in einem Plot dargestellt werden.\n\n## Darstellung der drei Modelle\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Input-Vektor mit x-Werten für die Modelle erstellen, der die Bandbreite der Daten abdeckt\nxv <- seq(min(SAR$area), max(SAR$area), 0.1)\n\nplot(SAR$area, SAR$richness) # Daten plotten\nabline(lm.1, col = \"red\") # Modell 1 (untransformiert) zu Plot hinzufügen\n\n# Modell 2 (Anhängige Variable log10-transformiert)\n# Modellvoraussagen berechnen\nlogyvlm2 <- predict(lm.2, list(area = xv))\n# Modellvoraussagen rücktransformieren\nyvlm2 <- 10^logyvlm2 # 10^ ist Umkekrfunktion von Log10\n# Zu Plot hinzufügen\nlines(xv, yvlm2, col = \"blue\") # Modell 2 auf untransformierte Fläche plotten\n\n# Modell 2 (beide Variablen log10-transformiert)\n# Modellvoraussagen berechnen\nlog10xv <- log10(xv) # Tansformierter Input-Vektor erstellen\nlogyvlm3 <- predict(lm.3, list(log_area = log10xv))\n# Modellvoraussagen rücktransformieren\nyvlm3 <- 10^logyvlm3 # 10^ ist Umkekrfunktion von Log10\nlines(xv, yvlm3, col = \"green\") # Modell 2 auf untransformierte Fläche plotten\n```\n\n::: {.cell-output-display}\n![](Statistik2_Loesung_1_files/figure-html/unnamed-chunk-16-1.png){width=672}\n:::\n:::\n\n\n\\--\\> Auch hier lässt sich bestätigen dass Modell lm2 (blau) die Daten am schlechtesten und Modell lm3 (grün) die Daten am besten abbildet.\n",
    "supporting": [
      "Statistik2_Loesung_1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}