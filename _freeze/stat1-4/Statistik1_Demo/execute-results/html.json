{
  "hash": "57f7c97d9ebd9ed9d50c27428066cbb0",
  "result": {
    "engine": "knitr",
    "markdown": "---\ndate: 2023-10-30\nlesson: Stat1\nthema: Grundlagen der Statistik\nformat:\n  html:\n    code-tools:\n      source: true\nknitr:\n    opts_chunk:\n        collapse: false\n---\n\n\n\n\n# Stat1: Demo\n\nDownload dieses Demoscript via \"\\</\\>Code\" (oben rechts)\n\n## Daten generieren und anschauen\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\na <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14)\nb <- c(12, 15, 16, 7, 8, 10, 12, 11, 13, 10)\nblume <- data.frame(a, b)\nblume\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    a  b\n1  20 12\n2  19 15\n3  25 16\n4  10  7\n5   8  8\n6  15 10\n7  13 12\n8  18 11\n9  11 13\n10 14 10\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(blume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       a               b        \n Min.   : 8.00   Min.   : 7.00  \n 1st Qu.:11.50   1st Qu.:10.00  \n Median :14.50   Median :11.50  \n Mean   :15.30   Mean   :11.40  \n 3rd Qu.:18.75   3rd Qu.:12.75  \n Max.   :25.00   Max.   :16.00  \n```\n\n\n:::\n\n```{.r .cell-code}\nboxplot(blume$a, blume$b)\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\nboxplot(blume)\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(blume$a)\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n```{.r .cell-code}\nhist(blume$b)\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n:::\n\n\n\n\n## Zweiseitiger t-Test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(blume$a, blume$b) # Zweiseitig \"Test auf a ≠ b\" (default)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  blume$a and blume$b\nt = 2.0797, df = 13.907, p-value = 0.05654\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -0.1245926  7.9245926\nsample estimates:\nmean of x mean of y \n     15.3      11.4 \n```\n\n\n:::\n:::\n\n\n\n\n## Einseitiger t-Test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nt.test(blume$a, blume$b, alternative = \"greater\") # Einseitig \"Test auf a > b\"\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  blume$a and blume$b\nt = 2.0797, df = 13.907, p-value = 0.02827\nalternative hypothesis: true difference in means is greater than 0\n95 percent confidence interval:\n 0.5954947       Inf\nsample estimates:\nmean of x mean of y \n     15.3      11.4 \n```\n\n\n:::\n\n```{.r .cell-code}\nt.test(blume$a, blume$b, alternative = \"less\") # Einseitig \"Test auf a < b\"\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  blume$a and blume$b\nt = 2.0797, df = 13.907, p-value = 0.9717\nalternative hypothesis: true difference in means is less than 0\n95 percent confidence interval:\n     -Inf 7.204505\nsample estimates:\nmean of x mean of y \n     15.3      11.4 \n```\n\n\n:::\n:::\n\n\n\n\n## Klassischer t-Test vs. Welch Test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Varianzen gleich: klassischer t-Test\nt.test(blume$a, blume$b, var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  blume$a and blume$b\nt = 2.0797, df = 18, p-value = 0.05212\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -0.03981237  7.83981237\nsample estimates:\nmean of x mean of y \n     15.3      11.4 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Varianzen ungleich: Welch's t-Test (siehe Titelzeile des R-Outputs!)\nt.test(blume$a, blume$b) # dasselbe wie var.equal = FALSE\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  blume$a and blume$b\nt = 2.0797, df = 13.907, p-value = 0.05654\nalternative hypothesis: true difference in means is not equal to 0\n95 percent confidence interval:\n -0.1245926  7.9245926\nsample estimates:\nmean of x mean of y \n     15.3      11.4 \n```\n\n\n:::\n:::\n\n\n\n\n## Gepaarter t-Test\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Gepaarter t-Test: erster Wert von a wird mit erstem Wert von\n# b gepaart, zweiter Wert von a mit zweitem von b ect.\nt.test(blume$a, blume$b, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  blume$a and blume$b\nt = 3.4821, df = 9, p-value = 0.006916\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 1.366339 6.433661\nsample estimates:\nmean difference \n            3.9 \n```\n\n\n:::\n\n```{.r .cell-code}\nt.test(blume$a, blume$b, paired = TRUE, alternative = \"greater\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  blume$a and blume$b\nt = 3.4821, df = 9, p-value = 0.003458\nalternative hypothesis: true mean difference is greater than 0\n95 percent confidence interval:\n 1.846877      Inf\nsample estimates:\nmean difference \n            3.9 \n```\n\n\n:::\n:::\n\n\n\n\nDasselbe mit einer \"long table\"\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# \"Long table\" erstellen\n\nlibrary(\"tidyr\")\n\nblume.long <- pivot_longer(blume, cols = c(\"a\", \"b\"), names_to = \"cultivar\", values_to = \"size\")\n\n\n# Daten anschauen\nsummary(blume.long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   cultivar              size      \n Length:20          Min.   : 7.00  \n Class :character   1st Qu.:10.00  \n Mode  :character   Median :12.50  \n                    Mean   :13.35  \n                    3rd Qu.:15.25  \n                    Max.   :25.00  \n```\n\n\n:::\n\n```{.r .cell-code}\nhead(blume.long)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 2\n  cultivar  size\n  <chr>    <dbl>\n1 a           20\n2 b           12\n3 a           19\n4 b           15\n5 a           25\n6 b           16\n```\n\n\n:::\n\n```{.r .cell-code}\nboxplot(size ~ cultivar, data = blume.long)\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Tests durchführen\nt.test(size ~ cultivar, blume.long, var.equal = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  size by cultivar\nt = 2.0797, df = 18, p-value = 0.05212\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -0.03981237  7.83981237\nsample estimates:\nmean in group a mean in group b \n           15.3            11.4 \n```\n\n\n:::\n\n```{.r .cell-code}\nt.test(size ~ cultivar, blume.long, paired = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPaired t-test\n\ndata:  size by cultivar\nt = 3.4821, df = 9, p-value = 0.006916\nalternative hypothesis: true mean difference is not equal to 0\n95 percent confidence interval:\n 1.366339 6.433661\nsample estimates:\nmean difference \n            3.9 \n```\n\n\n:::\n:::\n\n\n\n\n## Base R vs. ggplot2\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"ggplot2\")\n\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot()\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot() +\n  theme_classic()\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot(size = 1) +\n  theme_classic() +\n  theme(axis.line = element_line(size = 1)) +\n  theme(axis.title = element_text(size = 14)) +\n  theme(axis.text = element_text(size = 14))\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-7-3.png){width=672}\n:::\n\n```{.r .cell-code}\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot(size = 1) +\n  theme_classic() +\n  theme(\n    axis.line = element_line(size = 1), axis.ticks = element_line(size = 1),\n    axis.text = element_text(size = 20), axis.title = element_text(size = 20)\n  )\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-7-4.png){width=672}\n:::\n:::\n\n\n\n\nDefinieren von mytheme mit allen gewünschten Settings, das man zu Beginn einer Sitzung einmal laden und dann immer wieder ausführen kann (statt des langen Codes)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmytheme <- theme_classic() +\n  theme(\n    axis.line = element_line(color = \"black\", size = 1),\n    axis.text = element_text(size = 20, color = \"black\"),\n    axis.title = element_text(size = 20, color = \"black\"),\n    axis.ticks = element_line(size = 1, color = \"black\"),\n    axis.ticks.length = unit(.5, \"cm\")\n  )\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Schöne Boxplots erstellen\n\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot(size = 1) +\n  mytheme\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\nt_test <- t.test(size ~ cultivar, blume.long)\n\n# Mit p-Wert im Plot\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot(size = 1) +\n  mytheme +\n  annotate(\"text\",\n    x = \"b\", y = 24,\n    label = paste0(\"italic(p) == \", round(t_test$p.value, 3)), parse = TRUE, size = 8\n  )\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-9-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Ohne p-Wert im Plot (da dieser > 0.05)\nggplot(blume.long, aes(cultivar, size)) +\n  geom_boxplot(size = 1) +\n  mytheme +\n  labs(x = \"Cultivar\", y = \"Size (cm)\")\n```\n\n::: {.cell-output-display}\n![](Statistik1_Demo_files/figure-html/unnamed-chunk-9-3.png){width=672}\n:::\n:::\n\n\n\n\n## Binomialtest\n\nIn Klammern übergibt man die Anzahl der Erfolge und die Stichprobengrösse\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nbinom.test(84, 200) # Anzahl Frauen im Nationalrat (≙ 42.0 %; Stand 2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  84 and 200\nnumber of successes = 84, number of trials = 200, p-value = 0.02813\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.3507439 0.4916638\nsample estimates:\nprobability of success \n                  0.42 \n```\n\n\n:::\n\n```{.r .cell-code}\nbinom.test(116, 200) # Anzahl Männer im Nationalrat (≙ 58.0 %; Stand 2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  116 and 200\nnumber of successes = 116, number of trials = 200, p-value = 0.02813\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.5083362 0.6492561\nsample estimates:\nprobability of success \n                  0.58 \n```\n\n\n:::\n\n```{.r .cell-code}\nbinom.test(3, 7) # Anzahl Frauen im Bundesrat (≙ 42.9 %; Stand 2019)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tExact binomial test\n\ndata:  3 and 7\nnumber of successes = 3, number of trials = 7, p-value = 1\nalternative hypothesis: true probability of success is not equal to 0.5\n95 percent confidence interval:\n 0.09898828 0.81594843\nsample estimates:\nprobability of success \n             0.4285714 \n```\n\n\n:::\n:::\n\n\n\n\n## Chi-Quadrat-Test & Fishers Test\n\nErmitteln des kritischen Wertes\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nqchisq(0.95, 1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 3.841459\n```\n\n\n:::\n:::\n\n\n\n\n## Direkter Test in R (dazu Werte als Matrix nötig)\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Matrix mit Haarfarbe&Augenfarbe-Kombidnationen erstellen\n# 38 blond&blau, 14 dunkel&blau, 11 blond&braun,, 51 dunkel&braun\ncount <- matrix(c(38, 14, 11, 51), nrow = 2)\ncount # Check\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     [,1] [,2]\n[1,]   38   11\n[2,]   14   51\n```\n\n\n:::\n\n```{.r .cell-code}\nrownames(count) <- c(\"blond\", \"dunkel\") # Benennen für Übersicht\ncolnames(count) <- c(\"blau\", \"braun\") #  Benennen für Übersicht\ncount # Check\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n       blau braun\nblond    38    11\ndunkel   14    51\n```\n\n\n:::\n\n```{.r .cell-code}\n# Tests durchführen\nchisq.test(count)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's Chi-squared test with Yates' continuity correction\n\ndata:  count\nX-squared = 33.112, df = 1, p-value = 8.7e-09\n```\n\n\n:::\n\n```{.r .cell-code}\nfisher.test(count)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tFisher's Exact Test for Count Data\n\ndata:  count\np-value = 2.099e-09\nalternative hypothesis: true odds ratio is not equal to 1\n95 percent confidence interval:\n  4.746351 34.118920\nsample estimates:\nodds ratio \n  12.22697 \n```\n\n\n:::\n:::\n",
    "supporting": [
      "Statistik1_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}