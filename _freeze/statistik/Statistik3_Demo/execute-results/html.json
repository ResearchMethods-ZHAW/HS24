{
  "hash": "fe8ad798f65f3d8311367c4c842982a9",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlesson: Statistik3\nknitr:\n  opts_chunk: \n    collapse: false \n---\n\n\n\n# Statistik 3: Demo\n\n[Download dieses Demoscript ](../purl/Statistik3_Demo.R) (rechtsklick → speichern unter)\n\n\n\n## Korrelation vs. Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Korrelationen und Regressionen\n\n# Datensatz zum Einfluss von Stickstoffdepositionen auf den Pflanzenartenreichtum\nlibrary(readr)\nlibrary(ggplot2)\n\ndf <- read_delim(\"datasets/stat/Nitrogen.csv\", \";\")\n\nsummary(df)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  N_deposition   Species_richness\n Min.   : 2.00   Min.   :12.0    \n 1st Qu.: 9.00   1st Qu.:17.5    \n Median :20.00   Median :21.0    \n Mean   :20.53   Mean   :20.2    \n 3rd Qu.:30.50   3rd Qu.:23.0    \n Max.   :55.00   Max.   :28.0    \n```\n\n\n:::\n\n```{.r .cell-code}\n# Plotten der Beziehung\nggplot(df, aes(x = N_deposition, y = Species_richness)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Pearson Korrelation\n# zuerst Species_richness dann N_deposition\ncor.test(df$Species_richness, df$N_deposition, method = \"pearson\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  df$Species_richness and df$N_deposition\nt = -5.2941, df = 13, p-value = 0.0001453\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9405572 -0.5450218\nsample estimates:\n       cor \n-0.8265238 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Pearson Korrelation\n# zuerst Species_richness dann N_deposition\ncor.test(df$N_deposition, df$Species_richness, method = \"pearson\") # zuerst N_deposition dann Species_richness  \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tPearson's product-moment correlation\n\ndata:  df$N_deposition and df$Species_richness\nt = -5.2941, df = 13, p-value = 0.0001453\nalternative hypothesis: true correlation is not equal to 0\n95 percent confidence interval:\n -0.9405572 -0.5450218\nsample estimates:\n       cor \n-0.8265238 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Rang-Korrelation Spearman\ncor.test(df$Species_richness, df$N_deposition, method = \"spearman\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tSpearman's rank correlation rho\n\ndata:  df$Species_richness and df$N_deposition\nS = 1015.5, p-value = 0.0002259\nalternative hypothesis: true rho is not equal to 0\nsample estimates:\n       rho \n-0.8133721 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Rang-Korrelation Kendall\ncor.test(df$Species_richness, df$N_deposition, method = \"kendall\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKendall's rank correlation tau\n\ndata:  df$Species_richness and df$N_deposition\nz = -3.308, p-value = 0.0009398\nalternative hypothesis: true tau is not equal to 0\nsample estimates:\n      tau \n-0.657115 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Jetzt als Regression\nlm1 <- lm(Species_richness ~ N_deposition, data = df) # zuerst Species_richness dann N_deposition\nlm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Species_richness ~ N_deposition, data = df)\n\nCoefficients:\n (Intercept)  N_deposition  \n     25.6050       -0.2632  \n```\n\n\n:::\n\n```{.r .cell-code}\nlm2 <- lm(N_deposition ~ Species_richness, data = df) # zuerst N_deposition dann Species_richness  \nlm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = N_deposition ~ Species_richness, data = df)\n\nCoefficients:\n     (Intercept)  Species_richness  \n          72.957            -2.595  \n```\n\n\n:::\n\n```{.r .cell-code}\nanova(lm1) # ANOVA-Tabelle, 1. Möglichkeit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: Species_richness\n             Df Sum Sq Mean Sq F value    Pr(>F)    \nN_deposition  1 233.91 233.908  28.028 0.0001453 ***\nResiduals    13 108.49   8.346                      \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary.aov(lm1) # ANOVA-Tabelle, 2. Möglichkeit\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value   Pr(>F)    \nN_deposition  1  233.9  233.91   28.03 0.000145 ***\nResiduals    13  108.5    8.35                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(lm1) # Regressionskoeffizienten\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Species_richness ~ N_deposition, data = df)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.9184 -1.9992  0.4493  2.0015  4.6081 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  25.60502    1.26440  20.251 3.25e-11 ***\nN_deposition -0.26323    0.04972  -5.294 0.000145 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.889 on 13 degrees of freedom\nMultiple R-squared:  0.6831,\tAdjusted R-squared:  0.6588 \nF-statistic: 28.03 on 1 and 13 DF,  p-value: 0.0001453\n```\n\n\n:::\n\n```{.r .cell-code}\n# Signifikantes Ergebnis visualisieren\n\nggplot(df, aes(x = N_deposition, y = Species_richness)) +\n  geom_point() +\n  geom_abline(intercept = lm1$coefficients[1], slope = lm1$coefficients[2], color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n#BaseR Variante plot(Species_richness ~ N_deposition, data = df) + abline(lm1)\n```\n:::\n\n\n\n## Einfache und Polynomische Regression\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren \npred <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14, 25, 39, 38, 28, 24) # \"pred\" sei unsere unabhängige Variable\nresp <- c(12, 15, 10, 7, 2, 10, 12, 11, 13, 10, 9, 2, 4, 7, 13) # \"resp\" sei unsere abhängige Variable\ndata <- data.frame(pred, resp) # Dataframe erstellen\n\n# Daten anschauen\nggplot(data, aes(x = pred, y = resp)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modell definieren ud anschauen\nlm_1 <- lm(resp ~ pred) # Einfaches lineares Modell\nsummary(lm_1) # Modell anschauen\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = resp ~ pred)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-9.0549 -1.7015  0.5654  2.0617  5.6406 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  12.2879     2.4472   5.021 0.000234 ***\npred         -0.1541     0.1092  -1.412 0.181538    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 3.863 on 13 degrees of freedom\nMultiple R-squared:  0.1329,\tAdjusted R-squared:  0.06622 \nF-statistic: 1.993 on 1 and 13 DF,  p-value: 0.1815\n```\n\n\n:::\n:::\n\n-> kein signifikanter Zusammenhang im einfachen linearen Modell und entsprechend kleines Bestimmtheitsmass (adj. R^2^ = 0.07)\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Polynomische Regression Modell definieren und anschauen\nlm_quad <- lm(resp ~ pred + I(pred^2)) # lineares Modell mit quadratischem Termsummary\n\nsummary(lm_quad) # lineares Modell mit quadratischem Term anschauen\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = resp ~ pred + I(pred^2))\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-4.3866 -1.1018 -0.2027  1.3831  4.4211 \n\nCoefficients:\n             Estimate Std. Error t value Pr(>|t|)   \n(Intercept) -2.239308   3.811746  -0.587  0.56777   \npred         1.330933   0.360105   3.696  0.00306 **\nI(pred^2)   -0.031587   0.007504  -4.209  0.00121 **\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 2.555 on 12 degrees of freedom\nMultiple R-squared:  0.6499,\tAdjusted R-squared:  0.5915 \nF-statistic: 11.14 on 2 and 12 DF,  p-value: 0.001842\n```\n\n\n:::\n:::\n\n\n-> Signifikanter Zusammenhang und viel besseres Bestimmtheitsmass (adj. R^2^ = 0.60)\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelle darstellen\n\n# Vorhersagen der Modelle generieren\nxv <- seq(min(pred), max(pred), length = 100) # 100 x-Werte, mit denen man die Modelle \"füttern\" kann \ny_lm1 <- predict(lm_1, data.frame(pred = xv)) # Vorhersagen des quadratischen Modells für die y-Werte\ny_lm_quad <- predict(lm_quad, data.frame(pred = xv)) # Vorhersagen des quadratischen Modells für die y-Werte\nModPred <- data.frame(xv, y_lm1, y_lm_quad)\n\n# Modellvorhersagen plotten\n\nggplot(data, aes(x = pred, y = resp)) +\n  geom_point() +\n  geom_line(data = ModPred, aes(x = xv, y = y_lm1), color = \"red\", linetype = \"dashed\") + \n  geom_line(data = ModPred, aes(x = xv, y = y_lm_quad), color = \"blue\")\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Residualplots\npar(mfrow = c(2, 2))\nplot(lm_1, main = \"Lineares Modell\")\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(lm_quad, main = \"Quadratisches  Modell\")\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\n-> Die Plots sehen beim Modell mit quadratischem Term besser aus\n\n## ANCOVA\n\nExperiment zur Fruchtproduktion (\"Fruit\") von Ipomopsis sp. in Abhängigkeit von der Beweidung (\"Grazing\" mit 2 Levels: \"Grazed\", \"Ungrazed\") und korrigiert für die Pflanzengrösse vor der Beweidung (hier ausgedrückt als Durchmesser an der Spitze des Wurzelstock: \"Root\")\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten einlesen und anschauen\nlibrary(\"readr\")\n\ncompensation <- read_delim(\"datasets/stat/ipomopsis.csv\")\ncompensation$Grazing <- as.factor(compensation$Grazing)\n\nhead(compensation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 6 × 3\n   Root Fruit Grazing \n  <dbl> <dbl> <fct>   \n1  6.22  59.8 Ungrazed\n2  6.49  61.0 Ungrazed\n3  4.92  14.7 Ungrazed\n4  5.13  19.3 Ungrazed\n5  5.42  34.2 Ungrazed\n6  5.36  35.5 Ungrazed\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(compensation)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Root            Fruit            Grazing  \n Min.   : 4.426   Min.   : 14.73   Grazed  :20  \n 1st Qu.: 6.083   1st Qu.: 41.15   Ungrazed:20  \n Median : 7.123   Median : 60.88                \n Mean   : 7.181   Mean   : 59.41                \n 3rd Qu.: 8.510   3rd Qu.: 76.19                \n Max.   :10.253   Max.   :116.05                \n```\n\n\n:::\n\n```{.r .cell-code}\n# Plotten der vollständigen Daten/Information\nlibrary(\"ggplot2\")\nggplot(compensation, aes(x = Root, y = Fruit, color = Grazing)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\n-> Je grösser die Pflanze, desto grösser ihre Fruchtproduktion.\n-> Die grössere Fruchtproduktion innerhalb der beweideten Gruppe scheint ein Resultat von unterschiedlichen Pflanzengrössen zwischen den Gruppen zu sein.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Lineare Modelle definieren und anschauen\n\naoc_1 <- lm(Fruit ~ Root * Grazing, data = compensation) # Volles Modell mit Interaktion\nsummary.aov(aoc_1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Df Sum Sq Mean Sq F value   Pr(>F)    \nRoot          1  16795   16795 359.968  < 2e-16 ***\nGrazing       1   5264    5264 112.832 1.21e-12 ***\nRoot:Grazing  1      5       5   0.103     0.75    \nResiduals    36   1680      47                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\naoc_2 <- lm(Fruit ~ Grazing + Root, data = compensation) # Finales Modell ohne die (nicht signifikante) Interaktion\nsummary.aov(aoc_2) # ANOVA-Tabelle\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value  Pr(>F)    \nGrazing      1   2910    2910   63.93 1.4e-09 ***\nRoot         1  19149   19149  420.62 < 2e-16 ***\nResiduals   37   1684      46                    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(aoc_2) # Parameter-Tabelle\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = Fruit ~ Grazing + Root, data = compensation)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-17.1920  -2.8224   0.3223   3.9144  17.3290 \n\nCoefficients:\n                Estimate Std. Error t value Pr(>|t|)    \n(Intercept)     -127.829      9.664  -13.23 1.35e-15 ***\nGrazingUngrazed   36.103      3.357   10.75 6.11e-13 ***\nRoot              23.560      1.149   20.51  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.747 on 37 degrees of freedom\nMultiple R-squared:  0.9291,\tAdjusted R-squared:  0.9252 \nF-statistic: 242.3 on 2 and 37 DF,  p-value: < 2.2e-16\n```\n\n\n:::\n\n```{.r .cell-code}\n# Residualplots anschauen\npar(mfrow = c(2, 2)) # 2x2 Plots pro Grafik\nplot(aoc_2)\n```\n\n::: {.cell-output-display}\n![](Statistik3_Demo_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(1, 1)) # Grafik zurücksetzen\n```\n:::\n\n\n-> Das ANCOVA-Modell widerspiegelt die Zusammenhänge wie sie aufgrund der grafisch dargestellten Daten zu vermuten sind gut. Die Residual-Plots zeigen 3 Ausreisser (Beobachtungen 27, 34 und 37), welche \"aus der Reihe tanzen\".\n\n",
    "supporting": [
      "Statistik3_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}