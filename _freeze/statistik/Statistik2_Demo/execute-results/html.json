{
  "hash": "e4e03efb3ff174556f129501ade20a17",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlesson: Statistik2\nknitr:\n  opts_chunk: \n    collapse: false \n---\n\n\n\n# Statistik 2: Demo\n\n[Demoscript herunterladen (.R)](../purl/Statistik2_Demo.R){.dld}\n\n[Demoscript herunterladen (.qmd)](../purl/Statistik2_Demo.qmd){.dld}\n\n\n\n## ANOVA\n\n### t-test als ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Dieselben Daten wie für die t-Tests in Statistik 1\nMesswerte_a <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14) # Messwerte von Cultivar a\nMesswerte_b <- c(12, 15, 16, 7, 8, 10, 12, 11, 13, 10) # Messwerte von Cultivar b\ncultivar <- as.factor( c(rep(\"a\", 10), rep(\"b\", 10))) # Bezeichnug der Cultivare in der Tabelle\nblume <- data.frame(\"cultivar\" = cultivar, \"size\" = c(Messwerte_a, Messwerte_b)) # Data frame erstellen\n\n# Daten anschauen\nlibrary(ggplot2)\n\nggplot(blume, aes(x = cultivar, y = size, fill = cultivar)) +\n  geom_boxplot() + # Boxplots\n  geom_dotplot(binaxis = \"y\", stackdir = \"center\", alpha = 0.5) # Datenpunkte darstellen\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Klassischer t-Test ausführen\nt.test(size ~ cultivar, var.equal = TRUE, data = blume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tTwo Sample t-test\n\ndata:  size by cultivar\nt = 2.0797, df = 18, p-value = 0.05212\nalternative hypothesis: true difference in means between group a and group b is not equal to 0\n95 percent confidence interval:\n -0.03981237  7.83981237\nsample estimates:\nmean in group a mean in group b \n           15.3            11.4 \n```\n\n\n:::\n\n```{.r .cell-code}\n# ANOVA ausführen\naov(size ~ cultivar, data = blume)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = size ~ cultivar, data = blume)\n\nTerms:\n                cultivar Residuals\nSum of Squares     76.05    316.50\nDeg. of Freedom        1        18\n\nResidual standard error: 4.193249\nEstimated effects may be unbalanced\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary( aov(size ~ cultivar, data = blume))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value Pr(>F)  \ncultivar     1   76.0   76.05   4.325 0.0521 .\nResiduals   18  316.5   17.58                 \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary.lm( aov(size ~ cultivar, data = blume))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\naov(formula = size ~ cultivar, data = blume)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -2.575 -0.350  2.925  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.326   11.54 9.47e-10 ***\ncultivarb     -3.900      1.875   -2.08   0.0521 .  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.193 on 18 degrees of freedom\nMultiple R-squared:  0.1937,\tAdjusted R-squared:  0.1489 \nF-statistic: 4.325 on 1 and 18 DF,  p-value: 0.05212\n```\n\n\n:::\n:::\n\n\n### Echte ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Ein weiterer Cultivar hinzufügen\nMesswerte_c <-c(30, 19, 31, 23, 18, 25, 26, 24, 17, 20)\ncultivar <- as.factor( c(rep(\"a\", 10), rep(\"b\", 10), rep(\"c\", 10))) # Bezeichnug der Cultivare in der Tabelle\nblume2 <- data.frame(\"cultivar\" = cultivar, \"size\" = c(Messwerte_a, Messwerte_b, Messwerte_c)) # Data frame erstellen\n\n\n# Daten als Boxplots anschauen\nggplot(blume2, aes(x = cultivar, y = size, fill = cultivar)) +\n  geom_boxplot()  + # Boxplots\n  geom_dotplot(binaxis = \"y\", stackdir = \"center\", alpha = 0.5) # Datenpunkte darstellen\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Kennzahlen der Daten anschauen\n\nlibrary(\"dplyr\")\n\nblume2 |> \n  group_by(cultivar) |>\n  summarise(\n    Mean = mean(size), \n    SD = sd(size),\n    Min = min(size),\n    Max = max(size)\n  )\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 3 × 5\n  cultivar  Mean    SD   Min   Max\n  <fct>    <dbl> <dbl> <dbl> <dbl>\n1 a         15.3  5.21     8    25\n2 b         11.4  2.84     7    16\n3 c         23.3  4.85    17    31\n```\n\n\n:::\n\n```{.r .cell-code}\n# ANOVA durchführen\naov1 <- aov(size ~ cultivar, data = blume2)\naov1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = size ~ cultivar, data = blume2)\n\nTerms:\n                cultivar Residuals\nSum of Squares  736.0667  528.6000\nDeg. of Freedom        2        27\n\nResidual standard error: 4.424678\nEstimated effects may be unbalanced\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  736.1   368.0    18.8 7.68e-06 ***\nResiduals   27  528.6    19.6                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary.lm(aov1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\naov(formula = size ~ cultivar, data = blume2)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -3.375 -0.300  2.700  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.399  10.935 2.02e-11 ***\ncultivarb     -3.900      1.979  -1.971 0.059065 .  \ncultivarc      8.000      1.979   4.043 0.000395 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.425 on 27 degrees of freedom\nMultiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \nF-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n# Direkt als lineares Modell\nlm1 <- lm(size ~ cultivar, data = blume2)\nsummary(lm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = size ~ cultivar, data = blume2)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-7.300 -3.375 -0.300  2.700  9.700 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   15.300      1.399  10.935 2.02e-11 ***\ncultivarb     -3.900      1.979  -1.971 0.059065 .  \ncultivarc      8.000      1.979   4.043 0.000395 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 4.425 on 27 degrees of freedom\nMultiple R-squared:  0.582,\tAdjusted R-squared:  0.5511 \nF-statistic:  18.8 on 2 and 27 DF,  p-value: 7.683e-06\n```\n\n\n:::\n:::\n\n\n### Tukeys Posthoc-Test\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"agricolae\")\n\n# Sorten mit ihren Namen bezeichnen, damit keine Verwechslung mit den Post-Hoc-Labels entsteht\nblume2n <- blume2 \nblume2n$cultivar <- recode(blume2n$cultivar, \"a\" = \"Andro\", \"b\" = \"Bulli\", \"c\" = \"Chroma\")\n\n# ANOVA und Posthoc-Test durchführen\naov1 <- aov(size ~ cultivar, data = blume2n)\nposthoc <- HSD.test(aov1, \"cultivar\", console = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nStudy: aov1 ~ \"cultivar\"\n\nHSD Test for size \n\nMean Square Error:  19.57778 \n\ncultivar,  means\n\n       size      std  r       se Min Max   Q25  Q50   Q75\nAndro  15.3 5.207900 10 1.399206   8  25 11.50 14.5 18.75\nBulli  11.4 2.836273 10 1.399206   7  16 10.00 11.5 12.75\nChroma 23.3 4.854551 10 1.399206  17  31 19.25 23.5 25.75\n\nAlpha: 0.05 ; DF Error: 27 \nCritical Value of Studentized Range: 3.506426 \n\nMinimun Significant Difference: 4.906213 \n\nTreatments with the same letter are not significantly different.\n\n       size groups\nChroma 23.3      a\nAndro  15.3      b\nBulli  11.4      b\n```\n\n\n:::\n\n```{.r .cell-code}\nposthoc\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$statistics\n   MSerror Df     Mean       CV      MSD\n  19.57778 27 16.66667 26.54807 4.906213\n\n$parameters\n   test   name.t ntr StudentizedRange alpha\n  Tukey cultivar   3         3.506426  0.05\n\n$means\n       size      std  r       se Min Max   Q25  Q50   Q75\nAndro  15.3 5.207900 10 1.399206   8  25 11.50 14.5 18.75\nBulli  11.4 2.836273 10 1.399206   7  16 10.00 11.5 12.75\nChroma 23.3 4.854551 10 1.399206  17  31 19.25 23.5 25.75\n\n$comparison\nNULL\n\n$groups\n       size groups\nChroma 23.3      a\nAndro  15.3      b\nBulli  11.4      b\n\nattr(,\"class\")\n[1] \"group\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# Darstellung der Ergebnisse mit Post-Hoc-Labels über Boxplots\n\n# Labels des Posthoc-Tests extrahieren\nlabels <- posthoc$groups\nlabels$cultivar <- rownames(labels)\n\n#In Plot darstellen\nggplot(blume2n, aes(x = cultivar, y = size, fill = cultivar)) +\n  geom_boxplot() +\n  geom_dotplot(binaxis = \"y\", stackdir = \"center\", alpha = 0.5) +\n  geom_text(data = labels, aes(x = cultivar, y = 33, label = groups)) \n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n### 2-faktorielle ANOVA\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten generieren\nMesswerte_d <- c(10, 12, 11, 13, 10, 25, 12, 30, 26, 13)\nMesswerte_e <- c(15, 13, 18, 11, 14, 25, 39, 38, 28, 24)\nMesswerte_f <- c(10, 12, 11, 13, 10, 9, 2, 4, 7, 13)\n\n\nblume3 <- data.frame(\n    cultivar = c(rep(\"a\", 20), rep(\"b\", 20), rep(\"c\", 20)),\n    house = as.factor( c(rep(c(rep(\"yes\", 10), rep(\"no\", 10)), 3))),\n    size = c(Messwerte_a, Messwerte_b, Messwerte_c, Messwerte_d, Messwerte_e, Messwerte_f)\n)\n\nblume3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   cultivar house size\n1         a   yes   20\n2         a   yes   19\n3         a   yes   25\n4         a   yes   10\n5         a   yes    8\n6         a   yes   15\n7         a   yes   13\n8         a   yes   18\n9         a   yes   11\n10        a   yes   14\n11        a    no   12\n12        a    no   15\n13        a    no   16\n14        a    no    7\n15        a    no    8\n16        a    no   10\n17        a    no   12\n18        a    no   11\n19        a    no   13\n20        a    no   10\n21        b   yes   30\n22        b   yes   19\n23        b   yes   31\n24        b   yes   23\n25        b   yes   18\n26        b   yes   25\n27        b   yes   26\n28        b   yes   24\n29        b   yes   17\n30        b   yes   20\n31        b    no   10\n32        b    no   12\n33        b    no   11\n34        b    no   13\n35        b    no   10\n36        b    no   25\n37        b    no   12\n38        b    no   30\n39        b    no   26\n40        b    no   13\n41        c   yes   15\n42        c   yes   13\n43        c   yes   18\n44        c   yes   11\n45        c   yes   14\n46        c   yes   25\n47        c   yes   39\n48        c   yes   38\n49        c   yes   28\n50        c   yes   24\n51        c    no   10\n52        c    no   12\n53        c    no   11\n54        c    no   13\n55        c    no   10\n56        c    no    9\n57        c    no    2\n58        c    no    4\n59        c    no    7\n60        c    no   13\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten mit Boxplots anschauen\n# Base-R-Variante wäre: boxplot(size ~ cultivar + house, data = blume3)\nggplot(blume3, aes(x = interaction(cultivar, house), y = size, fill = cultivar)) +\n  geom_boxplot() +\n  geom_dotplot(binaxis = \"y\", stackdir = \"center\", alpha = 0.5)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n```{.r .cell-code}\nsummary( aov(size ~ cultivar + house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  417.1   208.5   5.005     0.01 *  \nhouse        1  992.3   992.3  23.815 9.19e-06 ***\nResiduals   56 2333.2    41.7                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary( aov(size ~ cultivar + house + cultivar:house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar        2  417.1   208.5   5.364   0.0075 ** \nhouse           1  992.3   992.3  25.520 5.33e-06 ***\ncultivar:house  2  233.6   116.8   3.004   0.0579 .  \nResiduals      54 2099.6    38.9                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Kurzschreibweise: \"*\" bedeutet, dass Interaktion zwischen cultivar und house eingeschlossen wird\nsummary( aov(size ~ cultivar * house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n               Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar        2  417.1   208.5   5.364   0.0075 ** \nhouse           1  992.3   992.3  25.520 5.33e-06 ***\ncultivar:house  2  233.6   116.8   3.004   0.0579 .  \nResiduals      54 2099.6    38.9                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary.lm( aov(size ~ cultivar + house, data = blume3))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\naov(formula = size ~ cultivar + house, data = blume3)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-9.733 -4.696 -1.050  2.717 19.133 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)    9.283      1.667   5.570 7.52e-07 ***\ncultivarb      6.400      2.041   3.135  0.00273 ** \ncultivarc      2.450      2.041   1.200  0.23509    \nhouseyes       8.133      1.667   4.880 9.19e-06 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 6.455 on 56 degrees of freedom\nMultiple R-squared:  0.3766,\tAdjusted R-squared:  0.3432 \nF-statistic: 11.28 on 3 and 56 DF,  p-value: 6.848e-06\n```\n\n\n:::\n\n```{.r .cell-code}\n# Interaktionsplots\n\ninteraction.plot(blume3$cultivar, blume3$house, blume3$size)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n\n```{.r .cell-code}\ninteraction.plot(blume3$house, blume3$cultivar, blume3$size)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-5-3.png){width=672}\n:::\n:::\n\n\n\n\n## Modelldiagnostik\n\n### Beispiel Modelldiagnostik\n\n::: {.cell}\n\n```{.r .cell-code}\n# Beispiel mit den blume Daten\npar(mfrow = c(2, 2)) # 4 Plots in einem Fenster\nplot( lm(Messwerte_b ~ Messwerte_a))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n:::\n\n\n### Beispiel Modelldiagnostik nicht ok\n\n::: {.cell}\n\n```{.r .cell-code}\n# Daten erstellen\ng <- c(20, 19, 25, 10, 8, 15, 13, 18, 11, 14, 25, 39, 38, 28, 24)\nh <- c(12, 15, 10, 7, 8, 10, 12, 11, 13, 10, 25, 12, 30, 26, 13)\nBsp <- data.frame(g, h)\n\n# Daten betrachten\nggplot(Bsp, aes(x = g, y = h)) +\n  geom_point() +\n  geom_smooth(method = \"lm\", se = FALSE)\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n\n```{.r .cell-code}\npar(mfrow = c(2, 2))\nplot(lm(h ~ g))\n```\n\n::: {.cell-output-display}\n![](Statistik2_Demo_files/figure-html/unnamed-chunk-7-2.png){width=672}\n:::\n:::\n\n\n\n## Nicht-parametrische Alternativen, wenn Modellannahmen der ANVOA massiv verletzt sind\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Nicht-parametrische Alternative zu t-Test\nwilcox.test(Messwerte_a, Messwerte_b)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWilcoxon rank sum test with continuity correction\n\ndata:  Messwerte_a and Messwerte_b\nW = 73, p-value = 0.08789\nalternative hypothesis: true location shift is not equal to 0\n```\n\n\n:::\n:::\n\n\n\n## Kruskal-Wallis-Test bei starken Abweichungen von der Normalverteilung, aber ähnlichen Varianzen\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Zum Vergleich normale ANOVA noch mal\nsummary(aov(size ~ cultivar, data = blume2))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n            Df Sum Sq Mean Sq F value   Pr(>F)    \ncultivar     2  736.1   368.0    18.8 7.68e-06 ***\nResiduals   27  528.6    19.6                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Kruskal-Wallis-Test\nkruskal.test(size ~ cultivar, data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tKruskal-Wallis rank sum test\n\ndata:  size by cultivar\nKruskal-Wallis chi-squared = 16.686, df = 2, p-value = 0.0002381\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Load library\nlibrary(\"FSA\")\n\n# Post-Hoc mit korrigierten p-Werte nach Bejamini-Hochberg\ndunnTest(size ~ cultivar, method = \"bh\", data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Comparison         Z      P.unadj        P.adj\n1      a - b  1.526210 1.269575e-01 0.1269575490\n2      a - c -2.518247 1.179407e-02 0.0176911039\n3      b - c -4.044457 5.244459e-05 0.0001573338\n```\n\n\n:::\n:::\n\n\n##  Welch-Test bei erheblicher Heteroskedastizität, aber relative normal/symmetrisch verteilten Residuen\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Welch-Test\noneway.test(size ~ cultivar, var.equal = F, data = blume2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  size and cultivar\nF = 21.642, num df = 2.000, denom df = 16.564, p-value = 2.397e-05\n```\n\n\n:::\n:::\n",
    "supporting": [
      "Statistik2_Demo_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}