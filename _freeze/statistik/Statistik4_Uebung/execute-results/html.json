{
  "hash": "499fb06f7164e8ca74d42e849bf6cc2d",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlesson: Statistik 4\nknitr:\n  opts_chunk: \n    collapse: false\nmusterloesung: false\n---\n\n\n\n\n# Statistik 4: Übung\n\n- Lesen Sie den Datensatz *steprasen_ukraine.csv* in R  ein. Dieser enthält Pflanzenartenzahlen (Species_richness) von 199 10 m² grossen Plots (Vegetationsaufnahmen) von Steppenrasen in der Ukraine sowie zahlreiche Umweltvariablen, deren Bedeutung und Einheiten im Kopf der ExcelTabelle angegeben sind.\n- **Ermitteln Sie ein minimal adäquates Modell, das den Artenreichtum in den Plots durch die Umweltvariablen erklärt.**\n- Bitte erklären und begründen Sie die einzelnen Schritte, die Sie unternehmen, um zu diesem Ergebnis zu kommen. Dazu erstellen Sie bitte ein mit Quarto generiertes html-Dokument, in das Sie Schritt für Schritt den verwendeten R-Code, die dazu gehörigen Ausgaben von R, Ihre Interpretation derselben und die sich ergebenden Schlussfolgerungen für das weitere Vorgehen dokumentieren.\n- Dieser Ablauf sollte insbesondere beinhalten:\n  - Überprüfen der Datenstruktur nach dem Einlesen: welches sind die abhängige(n)\n    und welches die unabängige(n) Variablen, sind alle Variablen für die Analyse\n    geeignet?\n  - Explorative Datenanalyse\n  - Definition eines globalen Modelles und dessen Reduktion zu einem minimal\n    adäquaten Modell\n  - Durchführen der Modelldiagnostik für dieses\n  - Generieren aller Zahlen, Statistiken und Tabellen, die für eine wiss.\n    Ergebnisdarstellung benötigt werden\n  - Formulieren Sie abschliessend einen Methoden- und Ergebnisteil (ggf. incl.\n    adäquaten Abbildungen) zu dieser Untersuchung in der Form einer\n    wissenschaftlichen Arbeit (ausformulierte schriftliche Zusammenfassung, mit je\n    einem Absatz von ca. 60-100 Worten, resp. 3-8 Sätzen für den Methoden- und\n    Ergebnisteil). D. h. alle wichtigen Informationen sollten enthalten sein, unnötige\n    Redundanz dagegen vermieden werden.\n    - **Zu erstellen sind (1) Ein quarto generiertes html-Dokument mit begründetem Lösungsweg (Kombination aus R-Code, R Output und dessen Interpretation) und (2) ausformulierter Methoden- und Ergebnisteil (für eine wiss. Arbeit).**\n\n\n::::{.content-hidden unless-meta=\"musterloesung\"}\n\n:::{.callout-note}\n\n## Lösung Übung 4\n\n[Demoscript herunterladen (.R)](../purl/Statistik4_Uebung.R){.dld}\n\n[Demoscript herunterladen (.qmd)](../purl/Statistik4_Uebung.qmd){.dld}\n\n\n- [Lösungstext als Download](Statistik_Loesung_4.pdf)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(pacman)\np_load(\"tidyverse\")\n\nukr <- read_delim(\"datasets/stat/steprasen_ukraine.csv\", delim = \";\")\nstr(ukr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nspc_tbl_ [199 × 20] (S3: spec_tbl_df/tbl_df/tbl/data.frame)\n $ PlotID           : chr [1:199] \"UA01NW\" \"UA01SE\" \"UA02NW\" \"UA02SE\" ...\n $ Species_richness : num [1:199] 44 53 48 50 53 40 46 56 30 35 ...\n $ Altitude         : num [1:199] 179 178 188 183 162 165 153 158 192 197 ...\n $ Inclination      : num [1:199] 24 17 27 33 7 33 30 32 25 18 ...\n $ Heat_index       : num [1:199] -0.42 -0.3 -0.51 -0.65 -0.09 -0.42 0 -0.59 0.46 0.32 ...\n $ Microrelief      : num [1:199] 5 2.5 2 2 3 4 16 15 5 3 ...\n $ Grazing_intensity: num [1:199] 0 0 0 0 0 0 1 1 0 0 ...\n $ Litter           : num [1:199] 12 10 0 4 15 30 5 6 10 20 ...\n $ Stones_and_rocks : num [1:199] 0 0 0 0 0 0 40 10 0 0 ...\n $ Gravel           : num [1:199] 0 0 0 0 0 0 0 0 0 0 ...\n $ Fine_soil        : num [1:199] 2 5 0 7 0 0 2 5 5 2 ...\n $ pH               : num [1:199] 7.32 6.91 6.72 6.44 6.1 6.23 6.79 6.43 7.19 7 ...\n $ Conductivity     : num [1:199] 90 115 126 90 73 76 163 119 151 69 ...\n $ CaCO3            : num [1:199] 0.0754 0.1271 0.0723 0.0771 0.0829 ...\n $ N_total          : num [1:199] 0.14 0.17 0.24 0.26 0.29 0.2 0.34 0.29 0.18 0.2 ...\n $ C_org            : num [1:199] 1.54 1.97 2.99 3.22 3.77 2.5 4.59 3.67 2.16 2.38 ...\n $ CN_ratio         : num [1:199] 10.8 11.5 12.5 12.6 12.8 ...\n $ Temperature      : num [1:199] 79 79 80 80 82 82 82 82 79 83 ...\n $ Temperature_range: num [1:199] 330 330 329 329 328 328 328 328 326 327 ...\n $ Precipitation    : num [1:199] 608 608 603 603 594 594 594 594 600 586 ...\n - attr(*, \"spec\")=\n  .. cols(\n  ..   PlotID = col_character(),\n  ..   Species_richness = col_double(),\n  ..   Altitude = col_double(),\n  ..   Inclination = col_double(),\n  ..   Heat_index = col_double(),\n  ..   Microrelief = col_double(),\n  ..   Grazing_intensity = col_double(),\n  ..   Litter = col_double(),\n  ..   Stones_and_rocks = col_double(),\n  ..   Gravel = col_double(),\n  ..   Fine_soil = col_double(),\n  ..   pH = col_double(),\n  ..   Conductivity = col_double(),\n  ..   CaCO3 = col_double(),\n  ..   N_total = col_double(),\n  ..   C_org = col_double(),\n  ..   CN_ratio = col_double(),\n  ..   Temperature = col_double(),\n  ..   Temperature_range = col_double(),\n  ..   Precipitation = col_double()\n  .. )\n - attr(*, \"problems\")=<externalptr> \n```\n\n\n:::\n:::\n\nMan erkennt, dass alle Spalten bis auf die erste mit der Plot ID numerisch (num) sind. Wir können nun die Variable \"PlotID\" als rownames setzten\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Setze erste Spalte (colum) als rownames\nukr <- ukr |>\n  column_to_rownames(var = \"PlotID\")\n```\n:::\n\nNun steht die abhängige Variable in Spalte 1 und die Prediktorvariablen in den Spalten  2 bis 19 stehen.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsummary(ukr)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n Species_richness    Altitude      Inclination      Heat_index      \n Min.   :14.00    Min.   : 73.0   Min.   : 1.00   Min.   :-0.94000  \n 1st Qu.:34.00    1st Qu.:140.0   1st Qu.:12.00   1st Qu.:-0.15500  \n Median :40.00    Median :166.0   Median :19.00   Median : 0.01000  \n Mean   :40.23    Mean   :161.7   Mean   :19.28   Mean   : 0.01603  \n 3rd Qu.:47.50    3rd Qu.:188.0   3rd Qu.:25.00   3rd Qu.: 0.21500  \n Max.   :67.00    Max.   :251.0   Max.   :48.00   Max.   : 0.85000  \n  Microrelief      Grazing_intensity     Litter      Stones_and_rocks\n Min.   :  0.000   Min.   :0.0000    Min.   : 0.00   Min.   : 0.000  \n 1st Qu.:  2.500   1st Qu.:0.0000    1st Qu.: 3.50   1st Qu.: 0.000  \n Median :  5.000   Median :1.0000    Median : 7.00   Median : 0.500  \n Mean   :  7.126   Mean   :0.9296    Mean   :12.16   Mean   : 3.994  \n 3rd Qu.:  7.000   3rd Qu.:2.0000    3rd Qu.:13.50   3rd Qu.: 4.000  \n Max.   :100.000   Max.   :3.0000    Max.   :90.00   Max.   :68.000  \n     Gravel         Fine_soil           pH         Conductivity  \n Min.   : 0.000   Min.   : 0.00   Min.   :4.890   Min.   : 40.0  \n 1st Qu.: 0.000   1st Qu.: 2.00   1st Qu.:7.240   1st Qu.:148.5  \n Median : 0.000   Median : 5.00   Median :7.420   Median :171.0  \n Mean   : 2.984   Mean   : 7.02   Mean   :7.286   Mean   :162.3  \n 3rd Qu.: 3.000   3rd Qu.:10.00   3rd Qu.:7.545   3rd Qu.:189.5  \n Max.   :40.000   Max.   :38.00   Max.   :7.790   Max.   :232.0  \n     CaCO3            N_total           C_org           CN_ratio    \n Min.   : 0.0042   Min.   :0.0700   Min.   : 1.040   Min.   : 6.04  \n 1st Qu.: 0.4306   1st Qu.:0.2000   1st Qu.: 2.850   1st Qu.:12.24  \n Median : 4.6578   Median :0.2700   Median : 3.560   Median :12.95  \n Mean   : 7.4757   Mean   :0.2788   Mean   : 3.689   Mean   :13.48  \n 3rd Qu.:13.0002   3rd Qu.:0.3300   3rd Qu.: 4.400   3rd Qu.:14.02  \n Max.   :35.2992   Max.   :0.9500   Max.   :11.300   Max.   :27.42  \n  Temperature    Temperature_range Precipitation  \n Min.   :78.00   Min.   :326.0     Min.   :577.0  \n 1st Qu.:82.00   1st Qu.:328.0     1st Qu.:583.0  \n Median :84.00   Median :329.0     Median :592.0  \n Mean   :84.82   Mean   :328.6     Mean   :596.4  \n 3rd Qu.:88.00   3rd Qu.:330.0     3rd Qu.:602.5  \n Max.   :92.00   Max.   :331.0     Max.   :630.0  \n```\n\n\n:::\n:::\n\n\nDa es sich bei Artenzahlen um Zähldaten handelt, müsste man theoretisch ein glm mit Poisson-Verteilung rechnen; bei einem Mittelwert, der hinreichend von Null verschieden ist (hier: ca. 40), ist eine Poisson-Verteilung aber praktisch nicht von einer Normalverteilung zu unterscheiden und wir können uns den Aufwand auch sparen).\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor <- cor(ukr[, 2:19])\ncor[abs(cor)<0.7] <- 0\ncor\n```\n:::\n\nDie Korrelationsanalyse dient dazu, zu entscheiden, ob die Prädiktorvariablen hinreichend voneinander unabhängig sind, um alle in das globale Modell hinein zu nehmen. Bei Pearson’s Korrelationskoeffizienten r, die betragsmässig grösser als 0.7 sind, würde es problematisch. Alternativ hätten wir auch den VIF (Variance Inflation Factor) als Kriterium für den möglichen Ausschluss von Variablen aus dem globalen Modell nehmen können. \n\nWenn man auf cor nun doppel-klickt und es in einem separaten Fenster öffnet, sieht man, wo es problematische Korrelationen zwischen Variablenpaaren gibt. Es sind dies Altitude vs. Temperature und N.total vs. C.org. Wir müssen aus jedem dieser Paare jetzt eine Variable rauswerfen, am besten jene, die weniger gut interpretierbar ist. Ich entscheide mich dafür Temperature statt Altitude (weil das der direktere ökologische Wirkfaktor ist) und C.org statt N.total zu behalten (weil es in der Literatur mehr Daten zum Humusgehalt als zum N-Gehalt gibt, damit eine bessere Vergleichbarkeit erzielt wird). Die Aussagen, die wir für die beibehaltene Variable erzielen, stehen aber +/- auch für die entfernte.\n\nDas Problem ist aber, dass wir immer noch 16 Variablen haben, was einen sehr leistungsfähigen Rechner oder sehr lange Rechenzeit erfordern würde. Wir sollten also unter 15 Variablen kommen. Wir könnten uns jetzt überlegen, welche uns ökologisch am wichtigsten sind, oder ein noch strengeres Kriterium bei r verwenden, etwa 0.6\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncor <- cor(ukr[, c(2:19)])\ncor[abs(cor) < 0.6] <- 0\ncor\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                    Altitude Inclination Heat_index Microrelief\nAltitude           1.0000000           0          0           0\nInclination        0.0000000           1          0           0\nHeat_index         0.0000000           0          1           0\nMicrorelief        0.0000000           0          0           1\nGrazing_intensity  0.0000000           0          0           0\nLitter             0.0000000           0          0           0\nStones_and_rocks   0.0000000           0          0           0\nGravel             0.0000000           0          0           0\nFine_soil          0.0000000           0          0           0\npH                 0.0000000           0          0           0\nConductivity       0.0000000           0          0           0\nCaCO3              0.0000000           0          0           0\nN_total            0.0000000           0          0           0\nC_org              0.0000000           0          0           0\nCN_ratio           0.0000000           0          0           0\nTemperature       -0.8309559           0          0           0\nTemperature_range -0.6794514           0          0           0\nPrecipitation      0.0000000           0          0           0\n                  Grazing_intensity Litter Stones_and_rocks Gravel Fine_soil\nAltitude                          0      0                0      0         0\nInclination                       0      0                0      0         0\nHeat_index                        0      0                0      0         0\nMicrorelief                       0      0                0      0         0\nGrazing_intensity                 1      0                0      0         0\nLitter                            0      1                0      0         0\nStones_and_rocks                  0      0                1      0         0\nGravel                            0      0                0      1         0\nFine_soil                         0      0                0      0         1\npH                                0      0                0      0         0\nConductivity                      0      0                0      0         0\nCaCO3                             0      0                0      0         0\nN_total                           0      0                0      0         0\nC_org                             0      0                0      0         0\nCN_ratio                          0      0                0      0         0\nTemperature                       0      0                0      0         0\nTemperature_range                 0      0                0      0         0\nPrecipitation                     0      0                0      0         0\n                        pH Conductivity CaCO3   N_total     C_org CN_ratio\nAltitude          0.000000     0.000000     0 0.0000000 0.0000000        0\nInclination       0.000000     0.000000     0 0.0000000 0.0000000        0\nHeat_index        0.000000     0.000000     0 0.0000000 0.0000000        0\nMicrorelief       0.000000     0.000000     0 0.0000000 0.0000000        0\nGrazing_intensity 0.000000     0.000000     0 0.0000000 0.0000000        0\nLitter            0.000000     0.000000     0 0.0000000 0.0000000        0\nStones_and_rocks  0.000000     0.000000     0 0.0000000 0.0000000        0\nGravel            0.000000     0.000000     0 0.0000000 0.0000000        0\nFine_soil         0.000000     0.000000     0 0.0000000 0.0000000        0\npH                1.000000     0.674678     0 0.0000000 0.0000000        0\nConductivity      0.674678     1.000000     0 0.0000000 0.0000000        0\nCaCO3             0.000000     0.000000     1 0.0000000 0.0000000        0\nN_total           0.000000     0.000000     0 1.0000000 0.9551133        0\nC_org             0.000000     0.000000     0 0.9551133 1.0000000        0\nCN_ratio          0.000000     0.000000     0 0.0000000 0.0000000        1\nTemperature       0.000000     0.000000     0 0.0000000 0.0000000        0\nTemperature_range 0.000000     0.000000     0 0.0000000 0.0000000        0\nPrecipitation     0.000000     0.000000     0 0.0000000 0.0000000        0\n                  Temperature Temperature_range Precipitation\nAltitude           -0.8309559        -0.6794514     0.0000000\nInclination         0.0000000         0.0000000     0.0000000\nHeat_index          0.0000000         0.0000000     0.0000000\nMicrorelief         0.0000000         0.0000000     0.0000000\nGrazing_intensity   0.0000000         0.0000000     0.0000000\nLitter              0.0000000         0.0000000     0.0000000\nStones_and_rocks    0.0000000         0.0000000     0.0000000\nGravel              0.0000000         0.0000000     0.0000000\nFine_soil           0.0000000         0.0000000     0.0000000\npH                  0.0000000         0.0000000     0.0000000\nConductivity        0.0000000         0.0000000     0.0000000\nCaCO3               0.0000000         0.0000000     0.0000000\nN_total             0.0000000         0.0000000     0.0000000\nC_org               0.0000000         0.0000000     0.0000000\nCN_ratio            0.0000000         0.0000000     0.0000000\nTemperature         1.0000000         0.6900784    -0.6237053\nTemperature_range   0.6900784         1.0000000     0.0000000\nPrecipitation      -0.6237053         0.0000000     1.0000000\n```\n\n\n:::\n:::\n\n\n\n\nEntsprechend „werfen“ wir auch noch die folgenden Variablen „raus“: Temperature.range (positiv mit Temperature), Precipitation (negativ mit Temperature) sowie Conductivity (positiv mit pH).\n\nNun können wir das globale Modell definieren, indem wir alle verbleibenden Variablen aufnehmen, das sind 13. (Wenn das nicht eh schon so viele wären, dass es uns an die Grenze der Rechenleistung bringt, hätten wir auch noch darüber nachdenken können, einzelne quadratische Terme oder Interaktionsterme zu berücksichtigen).\n\n\n::: {.cell}\n\n```{.r .cell-code}\nglobal_model <- lm(Species_richness ~ Inclination + Heat_index + Microrelief + Grazing_intensity +\n    Litter + Stones_and_rocks + Gravel + Fine_soil + pH + CaCO3 + C_org + CN_ratio + Temperature, data = ukr)\n```\n:::\n\n\nNun gibt es im Prinzip zwei Möglichkeiten, vom globalen (vollen) Modell zu einem minimal adäquaten Modell zu kommen. (1) Der Ansatz der „frequentist statistic“, in dem man aus dem vollen Modell so lange schrittweise Variablen entfernt, bis nur noch signifikante Variablen verbleiben. (2) Den informationstheoretischen Ansatz, bei dem alle denkbaren Modelle berechnet und verglichen werden (also alle möglichen Kombinationen von 13,12,…, 1, 0 Parametern). Diese Lösung stelle ich im Folgenden vor:\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Multimodel inference\np_load(\"MuMIn\")\n\noptions(na.action = \"na.fail\")\nallmodels <- dredge(global_model)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nallmodels\n```\n:::\n\n\nJetzt bekommen wir die besten der insgesamt 8192 möglichen Modelle gelistet mit ihren Parameterschätzungen und ihrem AICc.\n\nDas beste Modell umfasst 5 Parameter (CaCO3, CN.ratio, Grazing.intensity. Heat.index, Litter). Allerdings ist das nächstbeste Modell (mit 6 Parametern) nur wenig schlechter (delta AICc = 0.71), was sich in fast gleichen (und zudem sehr niedrigen) Akaike weights bemerkbar macht. Nach dem Verständnis des Information theoretician approach, sollte man in einer solchen Situation nicht das eine „beste“ Modell benennen, sondern eine Aussage über die Gruppe der insgesamt brauchbaren Modelle treffen. Hierzu kann man (a) Importance der Parameter über alle Modelle hinweg berechnen (= Summe der Akaike weights aller Modelle, die den betreffenden Parameter enthalten) und/oder (b) ein nach Akaike weights gemitteltes Modell berechnen.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Importance values der Variablen\nsw(allmodels)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     Heat_index Litter CaCO3 CN_ratio Grazing_intensity\nSum of weights:      1.00       0.92   0.82  0.73     0.68             \nN containing models: 4096       4096   4096  4096     4096             \n                     Stones_and_rocks Temperature Microrelief Gravel Fine_soil\nSum of weights:      0.43             0.39        0.33        0.31   0.31     \nN containing models: 4096             4096        4096        4096   4096     \n                     C_org pH   Inclination\nSum of weights:      0.30  0.26 0.26       \nN containing models: 4096  4096 4096       \n```\n\n\n:::\n:::\n\n\nDemnach ist Heat.index die wichtigste Variable (in 100% aller relevanten Modelle), während ferner Litter, CaCO3, CN_ratio und Grazing_intensity in mehr als 50% der relevanten Modelle enthalten sind.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelaveraging (Achtung: dauert mit 13 Variablen einige Minuten)\navgmodel <- model.avg(allmodels)\nsummary(avgmodel)\n```\n:::\n\n\nAus dem gemittelten Modell können wir die Richtung der Beziehung (positiv oder negativ) und ggf. die Effektgrössen (wie verändert sich die Artenzahl, wenn die Prädiktorvariable um eine Einheit zunimmt?) ermitteln.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Modelldiagnostik nicht vergessen\npar(mfrow = c(2, 2))\nplot(global_model)\n```\n\n::: {.cell-output-display}\n![](Statistik4_Uebung_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n\n```{.r .cell-code}\nplot(lm(Species_richness ~ Heat_index + Litter + CaCO3 + CN_ratio + Grazing_intensity, data = ukr))\n```\n\n::: {.cell-output-display}\n![](Statistik4_Uebung_files/figure-html/unnamed-chunk-12-2.png){width=672}\n:::\n:::\n\n\nWie immer kommt am Ende die Modelldiagnostik. Wir können uns entweder das globale Modell oder das Modell mit den 5 Variablen mit importance > 50% anschauen. Das Bild sieht fast identisch aus und zeigt keinerlei problematische Abweichungen, d. h. links oben weder ein Keil, noch eine Banane, rechts oben eine nahezu perfekte Gerade. \n\n:::\n:::: ",
    "supporting": [
      "Statistik4_Uebung_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}