{
  "hash": "69c159be585bc08457cc7b1992e1d6b6",
  "result": {
    "engine": "knitr",
    "markdown": "---\nlesson: RaumAn5\nthema: Multi-Criteria Evaluation (MCE)\nexecute: \n  echo: false   # set to true to show musterlösung\n  output: false # set to true to show musterlösung\ncode-fold: true\ncode-summary: \"Musterlösung\"\nknitr:\n  opts_chunk: \n    collapse: true  \n---\n\n\n# Rauman 5: Übung A\n\nIn der folgenden Übung möchten wir potentielle Standorte für Windkraftanlagen im Kanton Schwyz ermitteln. Zu diesem Zweck führen wir eine Multikriterien-Evaluation durch. Für diese Analyse stehen uns folgende Datensätze zur Verfügung:\n\n\n::: {#tbl-mce-data .cell tbl-cap='Auflistung der Geodaten, die wir für die Multikriterien-Analyse verwenden werden.\nDie Vektordaten sind alle als Layers im File *windkraft_geodata.gpkg*\nabgespeichert. Die Rasterdaten stehen als Geotiff *dhm250m.tif* und *wind250m.tif* zur Verfügung.\n'}\n::: {.cell-output-display}\n\n\n|Datensatz                  |Beschreibung                                        |Typ              |Format |crs            |\n|:--------------------------|:---------------------------------------------------|:----------------|:------|:--------------|\n|Untersuchungsgebiet_Schwyz |Kantonsgrenze des Kantons Schwyz                    |Vektor (Polygon) |gpkg   |CH1903 / LV03  |\n|Nationale_Schutzgebiete    |Nationale Schutzgebiete                             |Vektor (Polygon) |gpkg   |CH1903 / LV03  |\n|Strassen                   |Strassen Netzwerk aus SwissTLM3D                    |Vektor (Line)    |gpkg   |CH1903 / LV03  |\n|Bewohnte_Flaeche           |Siedlungsfläche                                     |Vektor (Polygon) |gpkg   |CH1903 / LV03  |\n|Waldgebiete                |Wald (TLM3d)                                        |Vektor (Polygon) |gpkg   |CH1903 / LV03  |\n|Seeflaechen                |Seen                                                |Vektor (Polygon) |gpkg   |CH1903 / LV03  |\n|wind250m.tif               |Mittlere Windgeschwindigkeit in m/s, 250m Auflösung |Raster           |tif    |CH1903+ / LV95 |\n|dhm250m.tif                |Digitales Höhenmodell in 250m Auflösung             |Raster           |tif    |CH1903+ / LV95 |\n\n\n:::\n:::\n\n\nIn diesem ersten Teil (Übung A) widmen wir uns, basierend auf @gilgen2010 und @tegou210, folgenden Parametern: \n\n- Erschliessung (je näher an der Strasse desto besser)\n- Distanz zu Schutzgebieten (je weiter weg desto besser).\n\nDiese Eignungsbewertung setzen wir in den folgenden Aufgaben in R um. Starte R und lade die nötigen Libraries in Eure Session (s.u.)\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\nlibrary(\"sf\")\nlibrary(\"terra\")\nlibrary(\"dplyr\")\nlibrary(\"tmap\")\nlibrary(\"ggplot2\")\n```\n:::\n\n\n## Aufgabe 1: Vektor Daten laden und anzeigen\n\nBetrachte das File *windkraft_geodata.gpkg* (siehe @tbl-mce-data). Dieses beinhaltet alle Vektordaten, die für die Bearbeitung der Multikriterien-Evaluation benötigt wird (Bewohnte Flächen, Nationale Schutzgebiete, Seeflächen, Strassen, Waldgebiete sowie die Kantonsgrenze von Schwyz). Die Namen der verfügbaren Listen können Sie mit `sf::st_layers()` ermitteln.\n\nImportiere die benötigten Vektordatensätze und exploriere die Daten. Zur Visualisierung könnt ihr die Funktionen `plot` oder die Packages `tmap` oder `ggplot2` verwenden.\n\nSchau dir auch das Koordinatensystem an. Was fällt dir auf? Wir würden gerne mit dem neuen Schweizer Koordinatensystem arbeiten (LV95). Um ein Koordinatensystem umzuwandeln, benutze die Funktion `st_transform()`. \n\n\n::: {.cell}\n\n:::\n\n\n## Aufgabe 2: Erschliessung berechnen {#sec-raster-distance}\n\nBeginnen wir mit dem Kriterium \"Erschliessung\". Wir müssen für den ganzen Kanton Schwyz wissen, wie weit die nächste Strasse entfernt ist. Wie wir bereits in @sec-raster-intro1 erläutert haben, lässt sich diese Information am besten in einem Raster abbilden.\n\nAnalog @sec-raster-intro1 müssen wir hierfür den Vektordatensatz auf der Basis eines Templates in ein Raster konvertieren. Für die Erstellung des Templates verwenden wir an dieser Stelle die Kantonsgrenze vom Kanton Schwyz.\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\n# Template mit der Ausdehnung und dem CRS von kt_schwyz\n# erstellen, und mit einer Auflösung von 250m\ntemplate <- rast(kt_schwyz, resolution = 250)\n\nstrassen_raster <- rasterize(strassen, template)\nstrassen_dist <- distance(strassen_raster)\n```\n:::\n\n\nNutze der obige Code, um den Strassen-Datensatz zu rasterisieren und die Distanz zur Strassen mit der Funktion `distance()` zu berechnen. Plausibilisiere den Output, indem du ihn visualisierst.\n\n\n::: {.cell .column-page layout-ncol=\"2\"}\n::: {.cell-output-display}\n![Die rasterisierte Form des \"Strassen\" Datensatzes](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![Die Distanz zur nächstgelegenen Strasse für jeden Punkt im Kanton Schwyz\"](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-5-2.png){width=672}\n:::\n:::\n\n\nFühre nun die gleiche Operation durch, um die Entfernung zu nationalen Schutzgebieten zu ermitteln.\n\n\n::: {.cell .column-page layout-ncol=\"2\"}\n::: {.cell-output-display}\n![Die rasterisierte Form des \"Schutzgebiete\" Datensatzes](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![Die Distanz zum nächstgelegenen Schutzgebiet für jeden Punkt im Kanton Schwyz\"](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n:::\n\n\n## Aufgabe 3: Distanzkriterien bewerten {#sec-classify1}\n\nJetzt haben wir die Distanzen zu den relevanten Gebieten berechnet. Nun müssen wir diese Distanzen bewerten. Dafür teilen wir die kontinuierlichen Distanzwerte in diskrete Kategorien ein. Wir verwenden für die Aufgabe folgende Einteilung aus der @tbl-bewerungstabelle-distanz.\n\nUm die Klassifizierung durchzuführen, brauchen wir die Function `classify()`. Wie wir aus der Dokumentation der Funktion (mit `?classify`) entnehmen können, gibt es verschiedene Wege, wie wir einen Raster reklassifizieren können (siehe Beschreibung für das Argument `rcl`).  Eine sehr explizite Variante ist, dass wir für `rcl` eine Matrix mit 3 Spalten verwenden. Diese drei Spalten stellen *from*, *to* und *becomes* dar. \n\nWir könnten diese Tabelle in einem Spreadsheet-Programm schreiben und in R einlesen. Alternativ können wir sie auch \"von Hand\" in R erstellen. Um in R tabellarische Daten zu schreiben, empfehlen wir die Funktion `tribble()`, welche eine sehr anschauliche Art bietet, Tabellen in R zu generieren. Da `classify` eine Matrix als Input will, müssen wir unser data.frame noch in eine Matrix umwandeln.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![Beispiel Distanzklassen anhand der Strassen](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nJetzt, wo wir diese Matrix haben, können wir sie nutzen, um den Kanton Schwyz hinsichtlich der Distanz zu Strassen zu bewerten. Dafür verwenden wir die Funktion `classify()` mit dem Argument `include.lowest = TRUE`, damit eine Distanz von 0m ebenfalls in 1 reklassifiziert wird.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n\nBewerte auf die gleiche Art die Distanz zu den Schutzgebieten. Wir nutzen die Schwellenwerte, wie sie in der nachstehenden Tabelle ersichtlich ist (@tbl-bewerungstabelle-distanz). Du kannst diese aber frei wählen.\n\n\n::: {.cell}\n\n:::\n\n\n<div class=\"mce-table\">\n\n\n::: {#tbl-bewerungstabelle-distanz .cell tbl-cap='Bewertungstabelle für die Distanz zu Strassen und Wildschutzgebieten (Meter)'}\n::: {.cell-output-display}\n`````{=html}\n<table class=\" lightable-classic\" style='font-family: \"Arial Narrow\", \"Source Sans Pro\", sans-serif; margin-left: auto; margin-right: auto;'>\n <thead>\n<tr>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Distanz zu Strassen</div></th>\n<th style=\"padding-bottom:0; padding-left:3px;padding-right:3px;text-align: center; \" colspan=\"3\"><div style=\"border-bottom: 1px solid #111111; margin-bottom: -1px; \">Distanz zu Wildschutzgebieten</div></th>\n</tr>\n  <tr>\n   <th style=\"text-align:right;\"> von </th>\n   <th style=\"text-align:right;\"> bis </th>\n   <th style=\"text-align:right;\"> zu </th>\n   <th style=\"text-align:right;\"> von </th>\n   <th style=\"text-align:right;\"> bis </th>\n   <th style=\"text-align:right;\"> zu </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 250 </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 250 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 250 </td>\n   <td style=\"text-align:right;\"> 500 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n   <td style=\"text-align:right;\"> 250 </td>\n   <td style=\"text-align:right;\"> 500 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 500 </td>\n   <td style=\"text-align:right;\"> 750 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n   <td style=\"text-align:right;\"> 500 </td>\n   <td style=\"text-align:right;\"> 750 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 750 </td>\n   <td style=\"text-align:right;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 0.4 </td>\n   <td style=\"text-align:right;\"> 750 </td>\n   <td style=\"text-align:right;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 0.6 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 1250 </td>\n   <td style=\"text-align:right;\"> 0.2 </td>\n   <td style=\"text-align:right;\"> 1000 </td>\n   <td style=\"text-align:right;\"> 1250 </td>\n   <td style=\"text-align:right;\"> 0.8 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 1250 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n   <td style=\"text-align:right;\"> 1250 </td>\n   <td style=\"text-align:right;\"> Inf </td>\n   <td style=\"text-align:right;\"> 1.0 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n</div>\n\n## Aufgabe 4: Raster Overlay {#sec-raster-overlay1}\n\nWir haben zwar erst zwei der Kriterien (Distanzen zu Strassen und Naturschutzgebiete) berechnet, die wir für unsere Standortsuche berücksichtigen wollen, doch mit denen können wir schon einmal eine erste, unvollständige Beurteilung wagen. \n\nWeil wir für alle Raster das gleiche Template verwendet haben, sind diese perfekt aneinander ausgerichtet. So können wir auf die denkbar einfachste Art die einezelnen Zellen miteinander verrechnen. Auf folgende Weise können wir beispielsweise den Mittlwert pro Zelle berechnen:\n\n\n::: {.cell}\n\n```{.r .cell-code  code-fold=\"false\"}\noverlay_prelim_1 <- (strassen_classify + schutzgebiete_classify) / 2\n\ntm_shape(overlay_prelim_1) +\n  tm_raster(palette = \"-Spectral\") +\n  tm_shape(kt_schwyz) +\n  tm_borders(lwd = 5, col = \"black\")\n```\n\n::: {.cell-output-display}\n![](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n## Aufgabe 5: Mask Raster {#sec-rauman5-mask}\n\nIm letzten Plot fällt auf, dass wir auch eine Bewertung für Gebiete ausserhalb des Untersuchungsgebiets haben. Da wir für diese Gebiete keine Geodaten verwendet haben, sind die Resultate ausserhalb des Untersuchungsgebiets nicht gültig. Deshalb ist es sinnvoll, die Werte ausserhalb des Untersuchungsgebeits zu entfernen. Dafür verwenden wir die Funktion `mask()` zusammen mit dem Vektordatensatz `kt_schwzy`. Diese setzt alle Werte ausserhalb des Polygons zu `NA`:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n## Aufgabe 6: Weighted Raster Overlay {#sec-raster-overlay1b}\n\nIm obigen Raster-Overlay haben wir alle Kriterien gleich stark gewichtet. Wir können aber auch eine gewichtete Verschneidung durchführen: Wenn wir beispielsweise die Distanz zu den Strassen stärker gewichten wollen als die Distanz zu den Schutzgebieten. Auch das ist sehr einfach:\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Rauman5_Uebung_A_files/figure-html/unnamed-chunk-13-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "Rauman5_Uebung_A_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}